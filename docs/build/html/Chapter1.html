

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Initialisation &mdash; librat  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="librat  documentation" href="index.html"/>
        <link rel="next" title="2. Basic librat / start operation" href="Chapter2.html"/>
        <link rel="prev" title="Welcome to librat" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> librat
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Initialisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Environment-variables">1.1. Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Making-files">1.2. Making files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Chapter2.html">2. Basic librat / start operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Appendix1.html">3. Appendix 1: <code class="docutils literal notranslate"><span class="pre">bash</span></code> help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">librat</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">1. </span>Initialisation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Chapter1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 7ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Initialisation">
<h1><span class="section-number">1. </span>Initialisation<a class="headerlink" href="#Initialisation" title="Permalink to this headline">¬∂</a></h1>
<p>Before proceeding, we make sure that an appropriate initialisation (‚Äòinit‚Äô) file has been generated. We also want to test that the software runs ok. We generate a <code class="docutils literal notranslate"><span class="pre">bash</span></code> shell to achieve this here, and use to his in subsequent notes.</p>
<p>You can modify any of this as a user, but be careful not to break it! üôÑ. In an emergency, you can always just re-download this set of notes and software from <a class="reference external" href="https://github.com/profLewis/librat">github</a> and start again.</p>
<p>If you want to know more about setting up this sort of file, and what it all means, see <a class="reference external" href="Appendix1">Appendix 1</a>. At the moment, you just need to be aware of it, not understand all of the intricacies.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="c1"># change directory from docs/source up to root</span>
<span class="nb">cd</span> ../..
<span class="nv">BPMS</span><span class="o">=</span><span class="si">${</span><span class="nv">BPMS</span><span class="p">-</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="si">}</span>
<span class="c1"># create the init.sh file we want</span>
<span class="nv">INIT</span><span class="o">=</span><span class="nv">$BPMS</span>/test/test_examples/init.sh

cat <span class="s">&lt;&lt;EOF &gt; $INIT</span>
<span class="s">#!/bin/bash</span>
<span class="s">#</span>
<span class="s"># preamble</span>
<span class="s">#</span>
<span class="s">export BPMS=$BPMS</span>
<span class="s"># set shell variables lib, bin, verbose</span>
<span class="s"># with defaults in case not set</span>
<span class="s">lib=\${lib-&quot;\$BPMS/src&quot;}</span>
<span class="s">bin=\${bin-&quot;\$BPMS/src&quot;}</span>
<span class="s">VERBOSE=\${VERBOSE-0}</span>

<span class="s"># set up required environment variables for bash</span>
<span class="s">export LD_LIBRARY_PATH=&quot;\${lib}:\${LD_LIBRARY_PATH}&quot;</span>
<span class="s">export DYLD_LIBRARY_PATH=&quot;\${lib}:\${DYLD_LIBRARY_PATH}&quot;</span>
<span class="s">export PATH=&quot;\${bin}:\${PATH}&quot;</span>

<span class="s"># set up required environment variables for librat</span>
<span class="s">export BPMSROOT=\${BPMSROOT-\$BPMS/test/test_examples}</span>

<span class="s">export MATLIB=\$BPMSROOT</span>
<span class="s">export RSRLIB=\$BPMSROOT</span>
<span class="s">export ARARAT_OBJECT=\$BPMSROOT</span>
<span class="s">export DIRECT_ILLUMINATION=\$BPMSROOT</span>
<span class="s">export BPMS_FILES=\$BPMSROOT</span>
<span class="s">if [ &quot;\$(which start)&quot; == &quot;\${bin}/start&quot; ]</span>
<span class="s">then</span>
<span class="s">  if [ &quot;\$VERBOSE&quot; == 1 ]; then</span>
<span class="s">      echo &quot;start found ok&quot;</span>
<span class="s">  fi</span>
<span class="s">else</span>
<span class="s">  # we should create them</span>
<span class="s">  make clean all</span>
<span class="s">fi</span>
<span class="s">EOF</span>
<span class="c1"># set executable mode</span>
chmod +x <span class="nv">$INIT</span>
</pre></div>
</div>
</div>
<p>Let‚Äôs look at the file we generated:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

cat ../../test/test_examples/init.sh
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#!/bin/bash
#
# preamble
#
export BPMS=/Users/plewis/librat
# set shell variables lib, bin, verbose
# with defaults in case not set
lib=${lib-&#34;$BPMS/src&#34;}
bin=${bin-&#34;$BPMS/src&#34;}
VERBOSE=${VERBOSE-0}

# set up required environment variables for bash
export LD_LIBRARY_PATH=&#34;${lib}:${LD_LIBRARY_PATH}&#34;
export DYLD_LIBRARY_PATH=&#34;${lib}:${DYLD_LIBRARY_PATH}&#34;
export PATH=&#34;${bin}:${PATH}&#34;

# set up required environment variables for librat
export BPMSROOT=${BPMSROOT-$BPMS/test/test_examples}

export MATLIB=$BPMSROOT
export RSRLIB=$BPMSROOT
export ARARAT_OBJECT=$BPMSROOT
export DIRECT_ILLUMINATION=$BPMSROOT
export BPMS_FILES=$BPMSROOT
if [ &#34;$(which start)&#34; == &#34;${bin}/start&#34; ]
then
  if [ &#34;$VERBOSE&#34; == 1 ]; then
      echo &#34;start found ok&#34;
  fi
else
  # we should create them
  make clean all
fi
</pre></div></div>
</div>
<div class="section" id="Environment-variables">
<h2><span class="section-number">1.1. </span>Environment variables<a class="headerlink" href="#Environment-variables" title="Permalink to this headline">¬∂</a></h2>
<p>We might notice that the init shell sets a number of environment variables, namely <code class="docutils literal notranslate"><span class="pre">MATLIB</span></code>, <code class="docutils literal notranslate"><span class="pre">RSRLIB</span></code> etc.</p>
<p>If you are interested, the meaning of these is given in the table below.</p>
<p>Alternatively, just notice that in the init shell, all of these variables are set to <code class="docutils literal notranslate"><span class="pre">BPMSROOT</span></code>, so if we want to point to the location of an object and material database for librat, we need only set the environment variable <code class="docutils literal notranslate"><span class="pre">BPMSROOT</span></code> appropriately. In this case it defaults to <code class="docutils literal notranslate"><span class="pre">$BPMS/test/test_example</span></code>.</p>
<p>If you want to run a shell that uses the <code class="docutils literal notranslate"><span class="pre">init.sh</span></code> setup, you will need to use the command <code class="docutils literal notranslate"><span class="pre">source</span></code> to export the variables to your shell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash

<span class="nb">source</span> ../../test/test_examples/init.sh

<span class="nb">echo</span> <span class="s2">&quot;MATLIB is set to </span><span class="nv">$MATLIB</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MATLIB is set to /Users/plewis/librat/test/test_examples
</pre></div></div>
</div>
<p><strong>Table explaining librat object environment variables:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>File types</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MATLIB</span></code></p></td>
<td><p>material library e.g. <code class="docutils literal notranslate"><span class="pre">`plants.matlib</span></code> &lt;test/test_examples/plants.matlib&gt;`__, all materials defined in a material library e.g. <code class="docutils literal notranslate"><span class="pre">`refl/white.dat</span></code> &lt;test/test_examples/refl/white.dat&gt;`__</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ARARAT_OBJECT</span></code></p></td>
<td><p>(extended) wavefront object files e.g. <code class="docutils literal notranslate"><span class="pre">`first.obj</span></code> &lt;test/test_examples/first.obj&gt;`__</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DIRECT_ILLUMINATION</span></code></p></td>
<td><p>spectral files for direct illumination: those defined in -RATdirect command line option</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RSRLIB</span></code></p></td>
<td><p>sensor waveband files: those defined in -RATsensor_wavebands command line option</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BPMS_FILES</span></code></p></td>
<td><p>Not used</p></td>
</tr>
</tbody>
</table>
<p>You can set all of these to the same value, in which case the database of files is all defined relative to that point. This is the most typical use of <code class="docutils literal notranslate"><span class="pre">librat</span></code>. We illustrate this setup below for the <code class="docutils literal notranslate"><span class="pre">librat</span></code> distribution, where a set of examples use files from the directory <code class="docutils literal notranslate"><span class="pre">test/test_example</span></code>.</p>
<p>Additionally, the following environment variables can be set to extend the size of some aspects of the model. You would only need to use these in some extreme case.</p>
<p><strong>Table explaining additional librat environment variables:</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAX_GROUPS</span></code></p></td>
<td><p>Maximum number of groups allowed (100000)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PRAT_MAX_MATERIALS</span></code></p></td>
<td><p>Maximum number of materials allowed (DEFAULT_PRAT_MAX_MATERIALS=1024 in <code class="docutils literal notranslate"><span class="pre">mtllib.h</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>You can test the init file by running the cell (shell) below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="c1"># test the init file</span>

<span class="c1"># change directory from docs/source up to root</span>
<span class="nv">INIT</span><span class="o">=</span>../../test/test_examples/init.sh

<span class="nb">export</span> <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">1</span>
<span class="nv">$INIT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
start found ok
</pre></div></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EXERCISE</span> <span class="mf">1.1</span>

    <span class="mf">1.</span> <span class="n">Try</span> <span class="n">changing</span> <span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span> <span class="n">VERBOSE</span> <span class="n">to</span> <span class="mi">1</span> <span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span> <span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">effect</span><span class="o">.</span>

    <span class="mf">2.</span> <span class="n">You</span> <span class="n">can</span> <span class="n">change</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">directory</span> <span class="n">where</span> <span class="n">the</span> <span class="nb">object</span> <span class="ow">and</span> <span class="n">material</span> <span class="n">files</span> <span class="n">are</span> <span class="n">through</span> <span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span> <span class="n">BPMSROOT</span><span class="o">.</span> <span class="n">See</span> <span class="k">if</span> <span class="n">you</span> <span class="n">can</span> <span class="n">find</span> <span class="n">what</span> <span class="n">BPMSROOT</span> <span class="ow">is</span> <span class="nb">set</span> <span class="n">to</span><span class="p">,</span> <span class="ow">and</span> <span class="n">also</span> <span class="n">see</span> <span class="k">if</span> <span class="n">yoiu</span> <span class="n">can</span> <span class="n">modify</span> <span class="n">it</span><span class="o">.</span>
</pre></div>
</div>
<p><strong>Answers below:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="c1">#----------------------</span>
<span class="c1"># this part same as above</span>
<span class="c1">#</span>
<span class="c1"># test the init file</span>
<span class="nv">INIT</span><span class="o">=</span>../../test/test_examples/init.sh
<span class="c1">#----------------------</span>

<span class="c1"># 1.1.1: Try changing the environment variable VERBOSE to 1</span>
<span class="c1"># (True) and 0 (False) to see the effect.</span>

<span class="c1"># ANSWER</span>
<span class="c1"># this sets verbose mode and prints a message</span>
<span class="c1"># &#39;start found ok&#39; if it finds the librat start</span>
<span class="c1"># executable</span>
<span class="nb">echo</span>  <span class="s2">&quot;----set VERBOSE 1---&quot;</span>
<span class="nb">export</span> <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">1</span>
<span class="nv">$INIT</span>

<span class="c1"># this turns off the verbose mode</span>
<span class="c1"># so no message is printed</span>
<span class="nb">echo</span> <span class="s2">&quot;----set VERBOSE 0---&quot;</span>
<span class="nb">export</span> <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">0</span>
<span class="nv">$INIT</span>

<span class="c1"># 1.1.2: You can change the name of the directory where the</span>
<span class="c1"># object and material files are through the</span>
<span class="c1"># environment variable BPMSROOT.</span>
<span class="c1"># See if you can find what BPMSROOT is set to,</span>
<span class="c1"># and also see if yoiu can modify it.</span>

<span class="c1"># ANSWER</span>
<span class="c1"># we need to see the value of the</span>
<span class="c1"># environment variable BPMSROOT, but we need it</span>
<span class="c1"># in this shell. So we *source* the file</span>
<span class="c1"># rather than running it.</span>
<span class="nb">echo</span> <span class="s2">&quot;----get BPMSROOT---&quot;</span>
<span class="nb">source</span> <span class="nv">$INIT</span>
<span class="nb">echo</span> <span class="s2">&quot;BPMSROOT is </span><span class="nv">$BPMSROOT</span><span class="s2">&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;----set BPMSROOT---&quot;</span>
<span class="c1"># To change it, just set it before sourcing</span>
<span class="nb">export</span> <span class="nv">BPMSROOT</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span>
<span class="nb">source</span> <span class="nv">$INIT</span>
<span class="nb">echo</span> <span class="s2">&quot;BPMSROOT is </span><span class="nv">$BPMSROOT</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----set VERBOSE 1---
start found ok
----set VERBOSE 0---
----get BPMSROOT---
BPMSROOT is /Users/plewis/librat/test/test_examples
----set BPMSROOT---
BPMSROOT is /tmp
</pre></div></div>
</div>
</div>
<div class="section" id="Making-files">
<h2><span class="section-number">1.2. </span>Making files<a class="headerlink" href="#Making-files" title="Permalink to this headline">¬∂</a></h2>
<p>We will create the files we need as we go along, using <code class="docutils literal notranslate"><span class="pre">bash</span></code> shell <code class="docutils literal notranslate"><span class="pre">cat</span> <span class="pre">&lt;&lt;EOF</span> <span class="pre">&gt;</span> <span class="pre">filename</span></code> syntax. You may have noticed that we did this above in creating the <code class="docutils literal notranslate"><span class="pre">init</span></code> file.</p>
<p>If we type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">&gt;</span> <span class="n">filename</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">line</span> <span class="mi">1</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">line</span> <span class="mi">2</span>
<span class="n">EOF</span>
</pre></div>
</div>
<p>then a file called <code class="docutils literal notranslate"><span class="pre">filename</span></code> will be generated, containing the information up to the <code class="docutils literal notranslate"><span class="pre">EOF</span></code> marker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">this</span> <span class="ow">is</span> <span class="n">line</span> <span class="mi">1</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">line</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Wew can try that now:</p>
<p>We first create a directory to do our work (using the <code class="docutils literal notranslate"><span class="pre">linux</span></code> command <code class="docutils literal notranslate"><span class="pre">mkdir</span></code> in a <code class="docutils literal notranslate"><span class="pre">bash</span></code> shell):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span>../..
mkdir -p <span class="nv">$BPMS</span>/test/test_examples
</pre></div>
</div>
</div>
<p>Now we will put some text in a file in that directory:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span>../..
<span class="nb">cd</span> <span class="nv">$BPMS</span>
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>

cat <span class="s">&lt;&lt;EOF &gt; $BPMS/test/test_examples/first.obj</span>
<span class="s"># My first object file</span>
<span class="s">mtllib plants.matlib</span>
<span class="s">usemtl green</span>
<span class="s">v 0 0 0</span>
<span class="s">v 0 0 1</span>
<span class="s">plane -1 -2</span>
<span class="s">!{</span>
<span class="s">usemtl white</span>
<span class="s">!{</span>
<span class="s">v 0 0 1000</span>
<span class="s">ell -1 30000 30000 30000</span>
<span class="s">!}</span>
<span class="s">!}</span>
<span class="s">EOF</span>

cat <span class="s">&lt;&lt;EOF &gt; $BPMS/test/test_examples/wavebands.dat</span>
<span class="s">1 1</span>
<span class="s">2 1</span>
<span class="s">EOF</span>

cat <span class="s">&lt;&lt;EOF &gt; $BPMS/test/test_examples/white.dat</span>
<span class="s">40 1.0</span>
<span class="s">300 0.5</span>
<span class="s">EOF</span>

cat <span class="s">&lt;&lt;EOF &gt; $BPMS/test/test_examples/plants.matlib</span>
<span class="s">srm green white.dat</span>
<span class="s">srm white white.dat</span>
<span class="s">EOF</span>
</pre></div>
</div>
</div>
<p>And now run a simple example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span>../..
<span class="nb">cd</span> <span class="nv">$BPMS</span>
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
<span class="nb">source</span> <span class="nv">$BPMS</span>/test/test_examples/init.sh

<span class="nb">echo</span> <span class="m">6</span> <span class="m">6</span> <span class="m">6</span> <span class="m">40000</span> <span class="m">0</span> <span class="m">0</span> -1 <span class="p">|</span> start -RATsensor_wavebands <span class="nv">$BPMS</span>/test/test_examples/wavebands.dat -RATsun_position <span class="m">0</span> <span class="m">1</span> <span class="m">1</span> <span class="nv">$BPMS</span>/test/test_examples/first.obj
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
RTD 0
order: 0        intersection point:     6.000000 6.000000 0.000020
                ray length:             39999.999980
                intersection material:  2
                sun 0:                  1 reflectance
lengthToSun: 7.874008 angleToSun 82.703725
                direct:                 0.127000 0.127000
                sky  :                  reflectance
                diffuse:                0.000000 0.000000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span>../..
<span class="nb">source</span> <span class="nv">$BPMS</span>/test/test_examples/init.sh

cat <span class="s">&lt;&lt;EOF | start $BPMS/test/test_examples/first.obj</span>
<span class="s">11</span>
<span class="s">1 2 0 1 1 1 1 1</span>
<span class="s">3 3 1 300 2 400 3 500</span>
<span class="s">4</span>
<span class="s">6 6 6 80000 0 0 -1</span>
<span class="s">EOF</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
x: -29994.000300 30006.000300
y: -29994.000300 30006.000300
z: 1000.200010 61012.200610
bbox centre @ 6.000000 6.000000 31006.200310
wavebands: 40.461336 304.242129 232.325066
RTD 0
order: 0        intersection point:     6.000000 6.000000 60999.998810
                ray length:             19000.001190
                intersection material:  3
                sun 0:                  1 reflectance
                direct:                 0.707248 0.707248 0.707248
                sun 1:                  1 reflectance
                direct:                 0.577581 0.577581 0.577581
                sky  :                  reflectance
                diffuse:                1.000000 1.000000 1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
how many sun vectors? (&gt;0): enter sun vector number 1 (3 floats): enter sun vector number 2 (3 floats):
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre>
<span></span>%%bash
<span class="nb">export</span> <span class="nv">BPMS</span><span class="o">=</span>../..
<span class="nb">source</span> <span class="nv">$BPMS</span>/test/test_examples/init.sh
<span class="nb">echo</span> <span class="m">10000</span> <span class="p">|</span> start <span class="nv">$BPMS</span>/test/test_examples/first.obj
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
options:
        -2                   : print PID
        -1                   : print memory use
         0                   : quit
         1 n s1x s1y s1z ... : set sun vectors
         2                   : print sun vectors
         3 n b1 w1 ...i bn wn: set wavebands
         4                   : print wavebands
         5 file.obj          : read object file
         6 fx fy fz dx dy dz : trace ray from f in direction d
         7                   : get and print materials
         8                   : print object information
         9                   : print info on materials used
         10                  : get and set verbosity level (0-1)
         11                  : get and print object bbox information
         12                    :
         13                  : same as 14 assuming filenames camera.dat light.dat
         14 camera.dat light.dat                : ray tracing using defined camera &amp; illumination
         15                    : dont go there
         16 cx cy cz sx sy nrows ncols rpp name : produce a height map in name
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Chapter2.html" class="btn btn-neutral float-right" title="2. Basic librat / start operation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to librat" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Prof. P. Lewis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ‚ù§Ô∏è  using a custom <a href="https://github.com/LinxiFan/Stanford-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>