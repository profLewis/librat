%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}


% Jupyter Notebook code cell colors
\definecolor{nbsphinxin}{HTML}{307FC1}
\definecolor{nbsphinxout}{HTML}{BF5B3D}
\definecolor{nbsphinx-code-bg}{HTML}{F5F5F5}
\definecolor{nbsphinx-code-border}{HTML}{E0E0E0}
\definecolor{nbsphinx-stderr}{HTML}{FFDDDD}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define an environment for non-plain-text code cell outputs (e.g. images)
\makeatletter
\newenvironment{nbsphinxfancyoutput}{%
    % Avoid fatal error with framed.sty if graphics too long to fit on one page
    \let\sphinxincludegraphics\nbsphinxincludegraphics
    \nbsphinx@image@maxheight\textheight
    \advance\nbsphinx@image@maxheight -2\fboxsep   % default \fboxsep 3pt
    \advance\nbsphinx@image@maxheight -2\fboxrule  % default \fboxrule 0.4pt
    \advance\nbsphinx@image@maxheight -\baselineskip
\def\nbsphinxfcolorbox{\spx@fcolorbox{nbsphinx-code-border}{white}}%
\def\FrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\@empty}%
\def\FirstFrameCommand{\nbsphinxfcolorbox\nbsphinxfancyaddprompt\sphinxVerbatim@Continues}%
\def\MidFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\sphinxVerbatim@Continues}%
\def\LastFrameCommand{\nbsphinxfcolorbox\sphinxVerbatim@Continued\@empty}%
\MakeFramed{\advance\hsize-\width\@totalleftmargin\z@\linewidth\hsize\@setminipage}%
\lineskip=1ex\lineskiplimit=1ex\raggedright%
}{\par\unskip\@minipagefalse\endMakeFramed}
\makeatother
\newbox\nbsphinxpromptbox
\def\nbsphinxfancyaddprompt{\ifvoid\nbsphinxpromptbox\else
    \kern\fboxrule\kern\fboxsep
    \copy\nbsphinxpromptbox
    \kern-\ht\nbsphinxpromptbox\kern-\dp\nbsphinxpromptbox
    \kern-\fboxsep\kern-\fboxrule\nointerlineskip
    \fi}
\newlength\nbsphinxcodecellspacing
\setlength{\nbsphinxcodecellspacing}{0pt}

% Define support macros for attaching opening and closing lines to notebooks
\newsavebox\nbsphinxbox
\makeatletter
\newcommand{\nbsphinxstartnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vtop{{#1\par}}
    % reserve some space at bottom of page, else start new page
    \needspace{\dimexpr2.5\baselineskip+\ht\nbsphinxbox+\dp\nbsphinxbox}
    % mimick vertical spacing from \section command
      \addpenalty\@secpenalty
      \@tempskipa 3.5ex \@plus 1ex \@minus .2ex\relax
      \addvspace\@tempskipa
      {\Large\@tempskipa\baselineskip
             \advance\@tempskipa-\prevdepth
             \advance\@tempskipa-\ht\nbsphinxbox
             \ifdim\@tempskipa>\z@
               \vskip \@tempskipa
             \fi}
    \unvbox\nbsphinxbox
    % if notebook starts with a \section, prevent it from adding extra space
    \@nobreaktrue\everypar{\@nobreakfalse\everypar{}}%
    % compensate the parskip which will get inserted by next paragraph
    \nobreak\vskip-\parskip
    % do not break here
    \nobreak
}% end of \nbsphinxstartnotebook

\newcommand{\nbsphinxstopnotebook}[1]{%
    \par
    % measure needed space
    \setbox\nbsphinxbox\vbox{{#1\par}}
    \nobreak % it updates page totals
    \dimen@\pagegoal
    \advance\dimen@-\pagetotal \advance\dimen@-\pagedepth
    \advance\dimen@-\ht\nbsphinxbox \advance\dimen@-\dp\nbsphinxbox
    \ifdim\dimen@<\z@
      % little space left
      \unvbox\nbsphinxbox
      \kern-.8\baselineskip
      \nobreak\vskip\z@\@plus1fil
      \penalty100
      \vskip\z@\@plus-1fil
      \kern.8\baselineskip
    \else
      \unvbox\nbsphinxbox
    \fi
}% end of \nbsphinxstopnotebook

% Ensure height of an included graphics fits in nbsphinxfancyoutput frame
\newdimen\nbsphinx@image@maxheight % set in nbsphinxfancyoutput environment
\newcommand*{\nbsphinxincludegraphics}[2][]{%
    \gdef\spx@includegraphics@options{#1}%
    \setbox\spx@image@box\hbox{\includegraphics[#1,draft]{#2}}%
    \in@false
    \ifdim \wd\spx@image@box>\linewidth
      \g@addto@macro\spx@includegraphics@options{,width=\linewidth}%
      \in@true
    \fi
    % no rotation, no need to worry about depth
    \ifdim \ht\spx@image@box>\nbsphinx@image@maxheight
      \g@addto@macro\spx@includegraphics@options{,height=\nbsphinx@image@maxheight}%
      \in@true
    \fi
    \ifin@
      \g@addto@macro\spx@includegraphics@options{,keepaspectratio}%
    \fi
    \setbox\spx@image@box\box\voidb@x % clear memory
    \expandafter\includegraphics\expandafter[\spx@includegraphics@options]{#2}%
}% end of "\MakeFrame"-safe variant of \sphinxincludegraphics
\makeatother

\makeatletter
\renewcommand*\sphinx@verbatim@nolig@list{\do\'\do\`}
\begingroup
\catcode`'=\active
\let\nbsphinx@noligs\@noligs
\g@addto@macro\nbsphinx@noligs{\let'\PYGZsq}
\endgroup
\makeatother
\renewcommand*\sphinxbreaksbeforeactivelist{\do\<\do\"\do\'}
\renewcommand*\sphinxbreaksafteractivelist{\do\.\do\,\do\:\do\;\do\?\do\!\do\/\do\>\do\-}
\makeatletter
\fvset{codes*=\sphinxbreaksattexescapedchars\do\^\^\let\@noligs\nbsphinx@noligs}
\makeatother



\title{librat}
\date{Apr 19, 2020}
\release{}
\author{Prof.\@{} P.\@{} Lewis}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


UCL Geography/NCEO librat software

\sphinxincludegraphics[width=262\sphinxpxdimen,height=85\sphinxpxdimen]{{ucl_logo}.png}


\chapter{Initialisation}
\label{\detokenize{Chapter1:Initialisation}}\label{\detokenize{Chapter1::doc}}
Before proceeding, we make sure that an appropriate initialisation (â€˜initâ€™) file has been generated. We also want to test that the software runs ok. We generate a \sphinxcode{\sphinxupquote{bash}} shell to achieve this here, and use to his in subsequent notes.

You can modify any of this as a user, but be careful not to break it! ðŸ™„. In an emergency, you can always just re\sphinxhyphen{}download this set of notes and software from \sphinxhref{https://github.com/profLewis/librat}{github} and start again.

If you want to know more about setting up this sort of file, and what it all means, see \sphinxhref{Appendix1}{Appendix 1}. At the moment, you just need to be aware of it, not understand all of the intricacies.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} create the init.sh file we want}
\PYG{n+nv}{INIT}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}INIT}
\PYG{l+s}{\PYGZsh{}!/bin/bash}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{\PYGZsh{} preamble}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{export BPMS=\PYGZdl{}BPMS}
\PYG{l+s}{\PYGZsh{} set shell variables lib, bin, verbose}
\PYG{l+s}{\PYGZsh{} with defaults in case not set}
\PYG{l+s}{lib=\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{bin=\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{VERBOSE=\PYGZbs{}\PYGZdl{}\PYGZob{}VERBOSE\PYGZhy{}0\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for bash}
\PYG{l+s}{export LD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}LD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export DYLD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}PATH\PYGZcb{}\PYGZdq{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for librat}
\PYG{l+s}{export BPMSROOT=\PYGZbs{}\PYGZdl{}\PYGZob{}BPMSROOT\PYGZhy{}\PYGZbs{}\PYGZdl{}BPMS/test/test\PYGZus{}examples\PYGZcb{}}

\PYG{l+s}{export MATLIB=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export RSRLIB=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export ARARAT\PYGZus{}OBJECT=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export DIRECT\PYGZus{}ILLUMINATION=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export BPMS\PYGZus{}FILES=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}(which start)\PYGZdq{} == \PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}/start\PYGZdq{} ]}
\PYG{l+s}{then}
\PYG{l+s}{  if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}VERBOSE\PYGZdq{} == 1 ]; then}
\PYG{l+s}{      echo \PYGZdq{}start found ok\PYGZdq{}}
\PYG{l+s}{  fi}
\PYG{l+s}{else}
\PYG{l+s}{  \PYGZsh{} we should create them}
\PYG{l+s}{  make clean all}
\PYG{l+s}{fi}
\PYG{l+s}{EOF}
\PYG{c+c1}{\PYGZsh{} set executable mode}
chmod +x \PYG{n+nv}{\PYGZdl{}INIT}
\end{sphinxVerbatim}
}

Letâ€™s look at the file we generated:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat ../../test/test\PYGZus{}examples/init.sh
\end{sphinxVerbatim}
}


\section{Environment variables}
\label{\detokenize{Chapter1:Environment-variables}}
We might notice that the init shell sets a number of environment variables, namely \sphinxcode{\sphinxupquote{MATLIB}}, \sphinxcode{\sphinxupquote{RSRLIB}} etc.

If you are interested, the meaning of these is given in the table below.

Alternatively, just notice that in the init shell, all of these variables are set to \sphinxcode{\sphinxupquote{BPMSROOT}}, so if we want to point to the location of an object and material database for librat, we need only set the environment variable \sphinxcode{\sphinxupquote{BPMSROOT}} appropriately. In this case it defaults to \sphinxcode{\sphinxupquote{\$BPMS/test/test\_example}}.

If you want to run a shell that uses the \sphinxcode{\sphinxupquote{init.sh}} setup, you will need to use the command \sphinxcode{\sphinxupquote{source}} to export the variables to your shell.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{source} ../../test/test\PYGZus{}examples/init.sh

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MATLIB is set to }\PYG{n+nv}{\PYGZdl{}MATLIB}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

\sphinxstylestrong{Table explaining librat object environment variables:}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
File types
\\
\hline
\sphinxcode{\sphinxupquote{MATLIB}}
&
material library e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}plants.matlib}} \textless{}test/test\_examples/plants.matlib\textgreater{}\textasciigrave{}\_\_, all materials defined in a material library e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}refl/white.dat}} \textless{}test/test\_examples/refl/white.dat\textgreater{}\textasciigrave{}\_\_
\\
\hline
\sphinxcode{\sphinxupquote{ARARAT\_OBJECT}}
&
(extended) wavefront object files e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_
\\
\hline
\sphinxcode{\sphinxupquote{DIRECT\_ILLUMINATION}}
&
spectral files for direct illumination: those defined in \sphinxhyphen{}RATdirect command line option
\\
\hline
\sphinxcode{\sphinxupquote{RSRLIB}}
&
sensor waveband files: those defined in \sphinxhyphen{}RATsensor\_wavebands command line option
\\
\hline
\sphinxcode{\sphinxupquote{BPMS\_FILES}}
&
Not used
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

You can set all of these to the same value, in which case the database of files is all defined relative to that point. This is the most typical use of \sphinxcode{\sphinxupquote{librat}}. We illustrate this setup below for the \sphinxcode{\sphinxupquote{librat}} distribution, where a set of examples use files from the directory \sphinxcode{\sphinxupquote{test/test\_example}}.

Additionally, the following environment variables can be set to extend the size of some aspects of the model. You would only need to use these in some extreme case.

\sphinxstylestrong{Table explaining additional librat environment variables:}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
Purpose
\\
\hline
\sphinxcode{\sphinxupquote{MAX\_GROUPS}}
&
Maximum number of groups allowed (100000)
\\
\hline
\sphinxcode{\sphinxupquote{PRAT\_MAX\_MATERIALS}}
&
Maximum number of materials allowed (DEFAULT\_PRAT\_MAX\_MATERIALS=1024 in \sphinxcode{\sphinxupquote{mtllib.h}})
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

You can test the init file by running the cell (shell) below.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{c+c1}{\PYGZsh{} test the init file}

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nv}{INIT}\PYG{o}{=}../../test/test\PYGZus{}examples/init.sh

\PYG{n+nb}{export} \PYG{n+nv}{VERBOSE}\PYG{o}{=}\PYG{l+m}{1}
\PYG{n+nv}{\PYGZdl{}INIT}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
start found ok
\end{sphinxVerbatim}
}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{EXERCISE} \PYG{l+m+mf}{1.1}

    \PYG{l+m+mf}{1.} \PYG{n}{Try} \PYG{n}{changing} \PYG{n}{the} \PYG{n}{environment} \PYG{n}{variable} \PYG{n}{VERBOSE} \PYG{n}{to} \PYG{l+m+mi}{1} \PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)} \PYG{o+ow}{or} \PYG{l+m+mi}{0} \PYG{p}{(}\PYG{k+kc}{False}\PYG{p}{)} \PYG{n}{to} \PYG{n}{see} \PYG{n}{the} \PYG{n}{effect}\PYG{o}{.}

    \PYG{l+m+mf}{2.} \PYG{n}{You} \PYG{n}{can} \PYG{n}{change} \PYG{n}{the} \PYG{n}{name} \PYG{n}{of} \PYG{n}{the} \PYG{n}{directory} \PYG{n}{where} \PYG{n}{the} \PYG{n+nb}{object} \PYG{o+ow}{and} \PYG{n}{material} \PYG{n}{files} \PYG{n}{are} \PYG{n}{through} \PYG{n}{the} \PYG{n}{environment} \PYG{n}{variable} \PYG{n}{BPMSROOT}\PYG{o}{.} \PYG{n}{See} \PYG{k}{if} \PYG{n}{you} \PYG{n}{can} \PYG{n}{find} \PYG{n}{what} \PYG{n}{BPMSROOT} \PYG{o+ow}{is} \PYG{n+nb}{set} \PYG{n}{to}\PYG{p}{,} \PYG{o+ow}{and} \PYG{n}{also} \PYG{n}{see} \PYG{k}{if} \PYG{n}{yoiu} \PYG{n}{can} \PYG{n}{modify} \PYG{n}{it}\PYG{o}{.}
\end{sphinxVerbatim}

\sphinxstylestrong{Answers below:}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{c+c1}{\PYGZsh{} this part same as above}
\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} test the init file}
\PYG{n+nv}{INIT}\PYG{o}{=}../../test/test\PYGZus{}examples/init.sh
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}

\PYG{c+c1}{\PYGZsh{} 1.1.1: Try changing the environment variable VERBOSE to 1}
\PYG{c+c1}{\PYGZsh{} (True) and 0 (False) to see the effect.}

\PYG{c+c1}{\PYGZsh{} ANSWER}
\PYG{c+c1}{\PYGZsh{} this sets verbose mode and prints a message}
\PYG{c+c1}{\PYGZsh{} \PYGZsq{}start found ok\PYGZsq{} if it finds the librat start}
\PYG{c+c1}{\PYGZsh{} executable}
\PYG{n+nb}{echo}  \PYG{l+s+s2}{\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}set VERBOSE 1\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
\PYG{n+nb}{export} \PYG{n+nv}{VERBOSE}\PYG{o}{=}\PYG{l+m}{1}
\PYG{n+nv}{\PYGZdl{}INIT}

\PYG{c+c1}{\PYGZsh{} this turns off the verbose mode}
\PYG{c+c1}{\PYGZsh{} so no message is printed}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}set VERBOSE 0\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
\PYG{n+nb}{export} \PYG{n+nv}{VERBOSE}\PYG{o}{=}\PYG{l+m}{0}
\PYG{n+nv}{\PYGZdl{}INIT}

\PYG{c+c1}{\PYGZsh{} 1.1.2: You can change the name of the directory where the}
\PYG{c+c1}{\PYGZsh{} object and material files are through the}
\PYG{c+c1}{\PYGZsh{} environment variable BPMSROOT.}
\PYG{c+c1}{\PYGZsh{} See if you can find what BPMSROOT is set to,}
\PYG{c+c1}{\PYGZsh{} and also see if yoiu can modify it.}

\PYG{c+c1}{\PYGZsh{} ANSWER}
\PYG{c+c1}{\PYGZsh{} we need to see the value of the}
\PYG{c+c1}{\PYGZsh{} environment variable BPMSROOT, but we need it}
\PYG{c+c1}{\PYGZsh{} in this shell. So we *source* the file}
\PYG{c+c1}{\PYGZsh{} rather than running it.}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}get BPMSROOT\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}INIT}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{BPMSROOT is }\PYG{n+nv}{\PYGZdl{}BPMSROOT}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}set BPMSROOT\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} To change it, just set it before sourcing}
\PYG{n+nb}{export} \PYG{n+nv}{BPMSROOT}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/tmp\PYGZdq{}}
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}INIT}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{BPMSROOT is }\PYG{n+nv}{\PYGZdl{}BPMSROOT}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
----set VERBOSE 1---
start found ok
----set VERBOSE 0---
----get BPMSROOT---
BPMSROOT is /Users/plewis/librat/test/test\_examples
----set BPMSROOT---
BPMSROOT is /tmp
\end{sphinxVerbatim}
}


\section{Making files}
\label{\detokenize{Chapter1:Making-files}}
We will create the files we need as we go along, using \sphinxcode{\sphinxupquote{bash}} shell \sphinxcode{\sphinxupquote{cat \textless{}\textless{}EOF \textgreater{} filename}} syntax. You may have noticed that we did this above in creating the \sphinxcode{\sphinxupquote{init}} file.

If we type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cat} \PYG{o}{\PYGZlt{}\PYGZlt{}}\PYG{n}{EOF} \PYG{o}{\PYGZgt{}} \PYG{n}{filename}
\PYG{n}{this} \PYG{o+ow}{is} \PYG{n}{line} \PYG{l+m+mi}{1}
\PYG{n}{this} \PYG{o+ow}{is} \PYG{n}{line} \PYG{l+m+mi}{2}
\PYG{n}{EOF}
\end{sphinxVerbatim}

then a file called \sphinxcode{\sphinxupquote{filename}} will be generated, containing the information up to the \sphinxcode{\sphinxupquote{EOF}} marker:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{this} \PYG{o+ow}{is} \PYG{n}{line} \PYG{l+m+mi}{1}
\PYG{n}{this} \PYG{o+ow}{is} \PYG{n}{line} \PYG{l+m+mi}{2}
\end{sphinxVerbatim}

Wew can try that now:

We first create a directory to do our work (using the \sphinxcode{\sphinxupquote{linux}} command \sphinxcode{\sphinxupquote{mkdir}} in a \sphinxcode{\sphinxupquote{bash}} shell):

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[18]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
mkdir \PYGZhy{}p \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples
\end{sphinxVerbatim}
}

Now we will put some text some files in that directory. We will be creating files that we need to run a radiative transfer simulation. We will look into what these mean and their formats later in the notes.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[67]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}BPMS}
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}

\PYG{c+c1}{\PYGZsh{} simple object file}
\PYG{c+c1}{\PYGZsh{} with green plane}
\PYG{c+c1}{\PYGZsh{} and sphere of radius 100 mm}
\PYG{c+c1}{\PYGZsh{} centred at (0,0,0)}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/first.obj}
\PYG{l+s}{\PYGZsh{} My first object file}
\PYG{l+s}{mtllib plants.matlib}
\PYG{l+s}{usemtl green}
\PYG{l+s}{v 0 0 0}
\PYG{l+s}{v 0 0 1}
\PYG{l+s}{plane \PYGZhy{}1 \PYGZhy{}2}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{usemtl white}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{v 0 0 0}
\PYG{l+s}{sph \PYGZhy{}1 100}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} wavelengths (nm)}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/wavebands.dat}
\PYG{l+s}{1 650}
\PYG{l+s}{2 550}
\PYG{l+s}{3 450}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} spectrum for white}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/white.dat}
\PYG{l+s}{450 1}
\PYG{l+s}{550 1}
\PYG{l+s}{650 1}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} spectrum for green}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/green.dat}
\PYG{l+s}{450 0.1}
\PYG{l+s}{550 0.5}
\PYG{l+s}{650 0.1}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} library listing materials}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/plants.matlib}
\PYG{l+s}{srm green green.dat}
\PYG{l+s}{srm white white.dat}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

And now run a simple example:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[68]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}BPMS}
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh

\PYG{n+nb}{echo} \PYG{l+m}{11} \PYG{p}{|} start \PYGZhy{}RATsensor\PYGZus{}wavebands \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/wavebands.dat \PYG{l+s+se}{\PYGZbs{}}
                \PYGZhy{}RATsun\PYGZus{}position \PYG{l+m}{0} \PYG{l+m}{1} \PYG{l+m}{1} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/first.obj
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
x: -99.980001 100.020001
y: -99.980001 100.020001
z: -99.980001 100.020001
bbox centre @ 0.020000 0.020000 0.020000
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[69]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}BPMS}
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh


\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{16 0 0 400 400 400  200 200 1 }\PYG{n+nv}{\PYGZdl{}BPMS}\PYG{l+s+s2}{/test/test\PYGZus{}examples/out.hips}\PYG{l+s+s2}{\PYGZdq{}} \PYG{p}{|} start \PYG{l+s+se}{\PYGZbs{}}
    \PYGZhy{}RATsensor\PYGZus{}wavebands \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/wavebands.dat  \PYG{l+s+se}{\PYGZbs{}}
    \PYGZhy{}RATv  \PYGZhy{}RATsun\PYGZus{}position \PYG{l+m}{0} \PYG{l+m}{1} \PYG{l+m}{1} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/first.obj
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
start:
        VERBOSE flag on (-v option)
read\_spectral\_file:   3 data entries read in file /Users/plewis/librat/test/test\_examples/wavebands.dat
( 99.9975)
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[70]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYG{k+kn}{from} \PYG{n+nn}{libhipl} \PYG{k+kn}{import} \PYG{n}{Hipl}
\PYG{k+kn}{import} \PYG{n+nn}{pylab} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{n}{f} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{../../test/test\PYGZus{}examples/out.hips}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{rabbit}\PYG{o}{=}\PYG{n}{Hipl}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{n}{f}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{imshow}\PYG{p}{(}\PYG{n}{rabbit}\PYG{p}{,}\PYG{n}{cmap}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gray}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{colorbar}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxout}[70]:\,\hspace{\fboxrule}\hspace{\fboxsep}}<matplotlib.colorbar.Colorbar at 0x116d4a6a0>
\end{sphinxVerbatim}
}

\hrule height -\fboxrule\relax
\vspace{\nbsphinxcodecellspacing}

\makeatletter\setbox\nbsphinxpromptbox\box\voidb@x\makeatother

\begin{nbsphinxfancyoutput}

\noindent\sphinxincludegraphics{{Chapter1_18_1}.svg}

\end{nbsphinxfancyoutput}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[65]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}BPMS}
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh

\PYG{n+nb}{echo} \PYG{l+m}{6} \PYG{l+m}{0} \PYG{l+m}{0} \PYG{l+m}{110} \PYG{l+m}{0} \PYG{l+m}{0} \PYGZhy{}1 \PYG{p}{|} start \PYGZhy{}RATsensor\PYGZus{}wavebands \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/wavebands.dat \PYGZhy{}RATsun\PYGZus{}position \PYG{l+m}{0} \PYG{l+m}{1} \PYG{l+m}{1} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/first.obj
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
RTD 0
order: 0        intersection point:     0.000000 0.000000 100.000010
                ray length:             9.999990
                intersection material:  3
                sun 0:                  no hit
                sky  :                  reflectance
                diffuse:                1.000000 1.000000
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[17]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{}\PYGZsh{}\PYGZsh{} wavebands}

\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh


\PYG{k}{for} i in \PYG{k}{\PYGZdl{}(}seq \PYG{l+m}{1} \PYG{l+m}{2} \PYG{l+m}{40}\PYG{k}{)}
\PYG{k}{do}
cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF | start \PYGZhy{}RATr \PYGZdl{}i \PYGZdl{}BPMS/test/test\PYGZus{}examples/first.obj}
\PYG{l+s}{3 3 200 20 300 20 400 20}
\PYG{l+s}{4}
\PYG{l+s}{EOF}
\PYG{k}{done}


\PYG{c+c1}{\PYGZsh{} wavelength is min and width}

\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
wavebands: 202.630756 315.112106 409.173003
wavebands: 207.892267 305.336319 407.519008
wavebands: 213.153779 315.560532 405.865013
wavebands: 218.415290 305.784745 404.211018
wavebands: 203.676802 316.008958 402.557024
wavebands: 208.938313 306.233171 400.903029
wavebands: 214.199825 316.457384 419.249034
wavebands: 219.461336 306.681597 417.595040
wavebands: 204.722848 316.905810 415.941045
wavebands: 209.984359 307.130022 414.287050
wavebands: 215.245871 317.354235 412.633055
wavebands: 200.507383 307.578448 410.979061
wavebands: 205.768894 317.802661 409.325066
wavebands: 211.030406 308.026874 407.671071
wavebands: 216.291917 318.251087 406.017077
wavebands: 201.553429 308.475300 404.363082
wavebands: 206.814940 318.699513 402.709087
wavebands: 212.076452 308.923726 401.055092
wavebands: 217.337963 319.147938 419.401098
wavebands: 202.599475 309.372151 417.747103
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[28]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{n+nb}{export} \PYG{n+nv}{BPMS}\PYG{o}{=}../..
\PYG{n+nb}{source} \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh
\PYG{n+nb}{echo} \PYG{l+m}{10000} \PYG{p}{|} start \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/first.obj
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
options:
        -2                   : print PID
        -1                   : print memory use
         0                   : quit
         1 n s1x s1y s1z {\ldots} : set sun vectors
         2                   : print sun vectors
         3 n b1 w1 {\ldots}i bn wn: set wavebands
         4                   : print wavebands
         5 file.obj          : read object file
         6 fx fy fz dx dy dz : trace ray from f in direction d
         7                   : get and print materials
         8                   : print object information
         9                   : print info on materials used
         10                  : get and set verbosity level (0-1)
         11                  : get and print object bbox information
         12                    :
         13                  : same as 14 assuming filenames camera.dat light.dat
         14 camera.dat light.dat                : ray tracing using defined camera \& illumination
         15                    : dont go there
         16 cx cy cz sx sy nrows ncols rpp name : produce a height map in name
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Basic librat / start operation}
\label{\detokenize{Chapter2:Basic-librat-/-start-operation}}\label{\detokenize{Chapter2::doc}}
Librat is the library of function calls around which you can write your own code to do things such as read in and parse an object file, read in and parse camera, illumination files, waveband files and so on. However, start is a wrapper code around these commands which gives you access to all the basic operations, and so is the de facto tool for doing simulations. The key things required to carry out a simulation are:
\begin{itemize}
\item {} 
A camera file

\item {} 
An illumination file

\item {} 
A waveband file

\item {} 
An object file \sphinxhyphen{} this is always assumed to be the last file on the start command line

\end{itemize}

Anything specific you want to do in any of these parts of the process is specified in these files. There are a limited number of additional command line options which either allow you to override a few key things in these files (the waveband file for example), or more usually are external to these things. Each of these can be passed through via the \sphinxcode{\sphinxupquote{\sphinxhyphen{}RAT}} keyword. Examples are the ray tree depth (\sphinxcode{\sphinxupquote{\sphinxhyphen{}RATm}}) , verbose level (\sphinxcode{\sphinxupquote{\sphinxhyphen{}RATv}}), waveband file (\sphinxcode{\sphinxupquote{\sphinxhyphen{}RATsensor\_wavebands}}) etc.


\bigskip\hrule\bigskip



\section{Object example 1: planes and ellipsoids}
\label{\detokenize{Chapter2:Object-example-1:-planes-and-ellipsoids}}

\bigskip\hrule\bigskip


{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
mkdir \PYGZhy{}p test/test\PYGZus{}examples
\end{sphinxVerbatim}
}

Now, a simple scene object \sphinxcode{\sphinxupquote{\textasciigrave{}test/test\_examples/first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} test/test\PYGZus{}examples/first.obj}
\PYG{l+s}{\PYGZsh{} My first object file}
\PYG{l+s}{mtllib plants.matlib}
\PYG{l+s}{usemtl white}
\PYG{l+s}{v 0 0 0}
\PYG{l+s}{v 0 0 1}
\PYG{l+s}{plane \PYGZhy{}1 \PYGZhy{}2}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{usemtl white}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{v 0 0 1000}
\PYG{l+s}{ell \PYGZhy{}1 30000 30000 1000}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

This object uses a material library \sphinxcode{\sphinxupquote{\textasciigrave{}plants.matlib}} \textless{}test/test\_examples/plants.matlib\textgreater{}\textasciigrave{}\_\_ that specifies the reflectance and transmittance properties of the scene materials.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} test/test\PYGZus{}examples/plants.matlib}
\PYG{l+s}{srm white refl/white.dat}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

In this example, the file contains the single line:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{srm} \PYG{n}{white} \PYG{n}{refl}\PYG{o}{/}\PYG{n}{white}\PYG{o}{.}\PYG{n}{dat}
\end{sphinxVerbatim}

so there is only a single material of type \sphinxcode{\sphinxupquote{srm}} (standard reflectance material \sphinxhyphen{} Lambertian reflectance (and/or transmittance). The material name is \sphinxcode{\sphinxupquote{white}} and the (ASCII) file giving the spectral reflectance function is \sphinxcode{\sphinxupquote{\textasciigrave{}refl/white.dat}} \textless{}test/test\_examples/refl/white.dat\textgreater{}\textasciigrave{}\_\_.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

mkdir \PYGZhy{}p test/test\PYGZus{}examples/refl

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} test/test\PYGZus{}examples/refl/white.dat}
\PYG{l+s}{0 1}
\PYG{l+s}{10000 1}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

The file \sphinxcode{\sphinxupquote{\textasciigrave{}refl/white.dat}} \textless{}test/test\_examples/refl/white.dat\textgreater{}\textasciigrave{}\_\_ contains 2 columns: column 1 is â€˜wavelengthâ€™ (really, a pseudo\sphinxhyphen{}wavelength in this case), column 2 is reflectance for that wavelength (wavelength units are arbitrary, but we usually use nm).

In this case, the file specifies:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{0} \PYG{l+m+mi}{1}
\PYG{l+m+mi}{10000} \PYG{l+m+mi}{1}
\end{sphinxVerbatim}

which is a reflectance of 1.0 for any wavelength (less than or equal to an arbitrary upper limit 10000). If the file specifies transmittance as well, this is given as a third column.

Looking back to \sphinxcode{\sphinxupquote{\textasciigrave{}test/test\_examples/first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_, the line:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mtllib} \PYG{n}{plants}\PYG{o}{.}\PYG{n}{matlib}
\end{sphinxVerbatim}

tells the librat reader to load the â€˜material libraryâ€™ called \sphinxcode{\sphinxupquote{\textasciigrave{}plants.matlib}} \textless{}test/test\_examples/plants.matlib\textgreater{}\textasciigrave{}\_\_. First, it will look in the current directory for the file. If it doesnâ€™t find it there, it will see if the environment variable \sphinxcode{\sphinxupquote{MATLIB}} is set. If so, it will look there next.


\section{Environment variables}
\label{\detokenize{Chapter2:Environment-variables}}
The following environmental variables can be used:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
File types
\\
\hline
\sphinxcode{\sphinxupquote{MATLIB}}
&
material library e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}plants.matlib}} \textless{}test/test\_examples/plants.matlib\textgreater{}\textasciigrave{}\_\_, all materials defined in a material library e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}refl/white.dat}} \textless{}test/test\_examples/refl/white.dat\textgreater{}\textasciigrave{}\_\_
\\
\hline
\sphinxcode{\sphinxupquote{ARARAT\_OBJECT}}
&
(extended) wavefront object files e.g. \sphinxcode{\sphinxupquote{\textasciigrave{}first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_
\\
\hline
\sphinxcode{\sphinxupquote{DIRECT\_ILLUMINATION}}
&
spectral files for direct illumination: those defined in \sphinxhyphen{}RATdirect command line option
\\
\hline
\sphinxcode{\sphinxupquote{RSRLIB}}
&
sensor waveband files: those defined in \sphinxhyphen{}RATsensor\_wavebands command line option
\\
\hline
\sphinxcode{\sphinxupquote{BPMS\_FILES}}
&
Not used
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

You can set all of these to the same value, in which case the database of files is all defined relative to that point. This is the most typical use of \sphinxcode{\sphinxupquote{librat}}. We illustrate this setup below for the \sphinxcode{\sphinxupquote{librat}} distribution, where a set of examples use files from the directory \sphinxcode{\sphinxupquote{test/test\_example}}.

Additionally, the following environment variables can be set to extend the size of some aspects of the model. You would only need to use these in some extreme case.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
Purpose
\\
\hline
\sphinxcode{\sphinxupquote{MAX\_GROUPS}}
&
Maximum number of groups allowed (100000)
\\
\hline
\sphinxcode{\sphinxupquote{PRAT\_MAX\_MATERIALS}}
&
Maximum number of materials allowed (DEFAULT\_PRAT\_MAX\_MATERIALS=1024 in \sphinxcode{\sphinxupquote{mtllib.h}})
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

In this case, we would want to set \sphinxcode{\sphinxupquote{MATLIB}} to \sphinxcode{\sphinxupquote{test/test\_examples}} before invoking \sphinxcode{\sphinxupquote{librat}}. In \sphinxcode{\sphinxupquote{bash}} for example, this is done with:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{export} \PYG{n+nv}{MATLIB}\PYG{o}{=}test/test\PYGZus{}examples
\end{sphinxVerbatim}
}

Letâ€™s put all of these into a shell called \sphinxcode{\sphinxupquote{\textasciigrave{}init.sh}} \textless{}test/test\_examples/init.sh\textgreater{}\textasciigrave{}\_\_:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} create the init.sh file we want}
\PYG{n+nv}{outfile}\PYG{o}{=}test/test\PYGZus{}examples/init.sh

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}outfile}
\PYG{l+s}{\PYGZsh{}!/bin/bash}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{\PYGZsh{} preamble}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{BPMS=\PYGZbs{}\PYGZdl{}\PYGZob{}BPMS\PYGZhy{}\PYGZbs{}\PYGZdl{}(pwd)\PYGZcb{}}
\PYG{l+s}{\PYGZsh{} set shell variables lib, bin, verbose}
\PYG{l+s}{\PYGZsh{} with defaults in case not set}
\PYG{l+s}{lib=\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{bin=\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{VERBOSE=\PYGZbs{}\PYGZdl{}\PYGZob{}VERBOSE\PYGZhy{}1\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for bash}
\PYG{l+s}{export LD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}LD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export DYLD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}PATH\PYGZcb{}\PYGZdq{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for librat}
\PYG{l+s}{export TEST=\PYGZbs{}\PYGZdl{}\PYGZob{}BPMS\PYGZcb{}/test/test\PYGZus{}example}
\PYG{l+s}{export MATLIB=\PYGZbs{}\PYGZdl{}TEST}
\PYG{l+s}{export RSRLIB=\PYGZbs{}\PYGZdl{}TEST}
\PYG{l+s}{export ARARAT\PYGZus{}OBJECT=\PYGZbs{}\PYGZdl{}TEST}
\PYG{l+s}{export DIRECT\PYGZus{}ILLUMINATION=\PYGZbs{}\PYGZdl{}TEST}
\PYG{l+s}{export BPMS\PYGZus{}FILES=\PYGZbs{}\PYGZdl{}TEST}

\PYG{l+s}{if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}(which start)\PYGZdq{} == \PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}/start\PYGZdq{} ]}
\PYG{l+s}{then}
\PYG{l+s}{  if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}VERBOSE\PYGZdq{} ]; then}
\PYG{l+s}{      echo \PYGZdq{}start found ok\PYGZdq{}}
\PYG{l+s}{  fi}
\PYG{l+s}{else}
\PYG{l+s}{  \PYGZsh{} we should create them}
\PYG{l+s}{  make clean all}
\PYG{l+s}{fi}
\PYG{l+s}{EOF}

\PYG{c+c1}{\PYGZsh{} set executable mode}
chmod +x \PYG{n+nv}{\PYGZdl{}outfile}
\PYG{c+c1}{\PYGZsh{} test run}
\PYG{n+nv}{\PYGZdl{}outfile}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{nbsphinx-stderr}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
make: *** No rule to make target `clean'.  Stop.
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\textcolor{ansi-red}{---------------------------------------------------------------------------}
\textcolor{ansi-red}{CalledProcessError}                        Traceback (most recent call last)
\textcolor{ansi-green}{<ipython-input-6-d988add8e183>} in \textcolor{ansi-cyan}{<module>}
\textcolor{ansi-green}{----> 1}\textcolor{ansi-red}{ }get\_ipython\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{.}run\_cell\_magic\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{'bash'}\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{''}\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{'\textbackslash{}n\# create the init.sh file we want\textbackslash{}noutfile=test/test\_examples/init.sh\textbackslash{}n\textbackslash{}ncat <<EOF > \$outfile\textbackslash{}n\#!/bin/bash\textbackslash{}n\#\textbackslash{}n\# preamble \textbackslash{}n\#\textbackslash{}nBPMS=\textbackslash{}\textbackslash{}\$\{BPMS-\textbackslash{}\textbackslash{}\$(pwd)\}\textbackslash{}n\# set shell variables lib, bin, verbose\textbackslash{}n\# with defaults in case not set \textbackslash{}nlib=\textbackslash{}\textbackslash{}\$\{lib-"\textbackslash{}\textbackslash{}\$BPMS/src"\}\textbackslash{}nbin=\textbackslash{}\textbackslash{}\$\{bin-"\textbackslash{}\textbackslash{}\$BPMS/src"\}\textbackslash{}nVERBOSE=\textbackslash{}\textbackslash{}\$\{VERBOSE-1\}\textbackslash{}n\textbackslash{}n\# set up required environment variables for bash\textbackslash{}nexport LD\_LIBRARY\_PATH="\textbackslash{}\textbackslash{}\$\{lib\}:\textbackslash{}\textbackslash{}\$\{LD\_LIBRARY\_PATH\}"\textbackslash{}nexport DYLD\_LIBRARY\_PATH="\textbackslash{}\textbackslash{}\$\{lib\}:\textbackslash{}\textbackslash{}\$\{DYLD\_LIBRARY\_PATH\}"\textbackslash{}nexport PATH="\textbackslash{}\textbackslash{}\$\{bin\}:\textbackslash{}\textbackslash{}\$\{PATH\}"\textbackslash{}n\textbackslash{}n\# set up required environment variables for librat\textbackslash{}nexport TEST=\textbackslash{}\textbackslash{}\$\{BPMS\}/test/test\_example\textbackslash{}nexport MATLIB=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport RSRLIB=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport ARARAT\_OBJECT=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport DIRECT\_ILLUMINATION=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport BPMS\_FILES=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}n\textbackslash{}nif [ "\textbackslash{}\textbackslash{}\$(which start)" == "\textbackslash{}\textbackslash{}\$\{bin\}/start" ]\textbackslash{}nthen\textbackslash{}n  if [ "\textbackslash{}\textbackslash{}\$VERBOSE" ]; then\textbackslash{}n      echo "start found ok"\textbackslash{}n  fi\textbackslash{}nelse\textbackslash{}n  \# we should create them\textbackslash{}n  make clean all \textbackslash{}nfi\textbackslash{}nEOF\textbackslash{}n\textbackslash{}n\# set executable mode\textbackslash{}nchmod +x \$outfile\textbackslash{}n\# test run\textbackslash{}n\$outfile\textbackslash{}n'}\textcolor{ansi-blue}{)}

\textcolor{ansi-green}{\textasciitilde{}/opt/anaconda3/envs/librat/lib/python3.8/site-packages/IPython/core/interactiveshell.py} in \textcolor{ansi-cyan}{run\_cell\_magic}\textcolor{ansi-blue}{(self, magic\_name, line, cell)}
\textcolor{ansi-green-intense}{\textbf{   2360}}             \textcolor{ansi-green}{with} self\textcolor{ansi-blue}{.}builtin\_trap\textcolor{ansi-blue}{:}
\textcolor{ansi-green-intense}{\textbf{   2361}}                 args \textcolor{ansi-blue}{=} \textcolor{ansi-blue}{(}magic\_arg\_s\textcolor{ansi-blue}{,} cell\textcolor{ansi-blue}{)}
\textcolor{ansi-green}{-> 2362}\textcolor{ansi-red}{                 }result \textcolor{ansi-blue}{=} fn\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{*}args\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{**}kwargs\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{   2363}}             \textcolor{ansi-green}{return} result
\textcolor{ansi-green-intense}{\textbf{   2364}}

\textcolor{ansi-green}{\textasciitilde{}/opt/anaconda3/envs/librat/lib/python3.8/site-packages/IPython/core/magics/script.py} in \textcolor{ansi-cyan}{named\_script\_magic}\textcolor{ansi-blue}{(line, cell)}
\textcolor{ansi-green-intense}{\textbf{    140}}             \textcolor{ansi-green}{else}\textcolor{ansi-blue}{:}
\textcolor{ansi-green-intense}{\textbf{    141}}                 line \textcolor{ansi-blue}{=} script
\textcolor{ansi-green}{--> 142}\textcolor{ansi-red}{             }\textcolor{ansi-green}{return} self\textcolor{ansi-blue}{.}shebang\textcolor{ansi-blue}{(}line\textcolor{ansi-blue}{,} cell\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    143}}
\textcolor{ansi-green-intense}{\textbf{    144}}         \textcolor{ansi-red}{\# write a basic docstring:}

\textcolor{ansi-green}{<decorator-gen-110>} in \textcolor{ansi-cyan}{shebang}\textcolor{ansi-blue}{(self, line, cell)}

\textcolor{ansi-green}{\textasciitilde{}/opt/anaconda3/envs/librat/lib/python3.8/site-packages/IPython/core/magic.py} in \textcolor{ansi-cyan}{<lambda>}\textcolor{ansi-blue}{(f, *a, **k)}
\textcolor{ansi-green-intense}{\textbf{    185}}     \textcolor{ansi-red}{\# but it's overkill for just that one bit of state.}
\textcolor{ansi-green-intense}{\textbf{    186}}     \textcolor{ansi-green}{def} magic\_deco\textcolor{ansi-blue}{(}arg\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{:}
\textcolor{ansi-green}{--> 187}\textcolor{ansi-red}{         }call \textcolor{ansi-blue}{=} \textcolor{ansi-green}{lambda} f\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{*}a\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{**}k\textcolor{ansi-blue}{:} f\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{*}a\textcolor{ansi-blue}{,} \textcolor{ansi-blue}{**}k\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    188}}
\textcolor{ansi-green-intense}{\textbf{    189}}         \textcolor{ansi-green}{if} callable\textcolor{ansi-blue}{(}arg\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{:}

\textcolor{ansi-green}{\textasciitilde{}/opt/anaconda3/envs/librat/lib/python3.8/site-packages/IPython/core/magics/script.py} in \textcolor{ansi-cyan}{shebang}\textcolor{ansi-blue}{(self, line, cell)}
\textcolor{ansi-green-intense}{\textbf{    243}}             sys\textcolor{ansi-blue}{.}stderr\textcolor{ansi-blue}{.}flush\textcolor{ansi-blue}{(}\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    244}}         \textcolor{ansi-green}{if} args\textcolor{ansi-blue}{.}raise\_error \textcolor{ansi-green}{and} p\textcolor{ansi-blue}{.}returncode\textcolor{ansi-blue}{!=}\textcolor{ansi-cyan}{0}\textcolor{ansi-blue}{:}
\textcolor{ansi-green}{--> 245}\textcolor{ansi-red}{             }\textcolor{ansi-green}{raise} CalledProcessError\textcolor{ansi-blue}{(}p\textcolor{ansi-blue}{.}returncode\textcolor{ansi-blue}{,} cell\textcolor{ansi-blue}{,} output\textcolor{ansi-blue}{=}out\textcolor{ansi-blue}{,} stderr\textcolor{ansi-blue}{=}err\textcolor{ansi-blue}{)}
\textcolor{ansi-green-intense}{\textbf{    246}}
\textcolor{ansi-green-intense}{\textbf{    247}}     \textcolor{ansi-green}{def} \_run\_script\textcolor{ansi-blue}{(}self\textcolor{ansi-blue}{,} p\textcolor{ansi-blue}{,} cell\textcolor{ansi-blue}{,} to\_close\textcolor{ansi-blue}{)}\textcolor{ansi-blue}{:}

\textcolor{ansi-red}{CalledProcessError}: Command 'b'\textbackslash{}n\# create the init.sh file we want\textbackslash{}noutfile=test/test\_examples/init.sh\textbackslash{}n\textbackslash{}ncat <<EOF > \$outfile\textbackslash{}n\#!/bin/bash\textbackslash{}n\#\textbackslash{}n\# preamble \textbackslash{}n\#\textbackslash{}nBPMS=\textbackslash{}\textbackslash{}\$\{BPMS-\textbackslash{}\textbackslash{}\$(pwd)\}\textbackslash{}n\# set shell variables lib, bin, verbose\textbackslash{}n\# with defaults in case not set \textbackslash{}nlib=\textbackslash{}\textbackslash{}\$\{lib-"\textbackslash{}\textbackslash{}\$BPMS/src"\}\textbackslash{}nbin=\textbackslash{}\textbackslash{}\$\{bin-"\textbackslash{}\textbackslash{}\$BPMS/src"\}\textbackslash{}nVERBOSE=\textbackslash{}\textbackslash{}\$\{VERBOSE-1\}\textbackslash{}n\textbackslash{}n\# set up required environment variables for bash\textbackslash{}nexport LD\_LIBRARY\_PATH="\textbackslash{}\textbackslash{}\$\{lib\}:\textbackslash{}\textbackslash{}\$\{LD\_LIBRARY\_PATH\}"\textbackslash{}nexport DYLD\_LIBRARY\_PATH="\textbackslash{}\textbackslash{}\$\{lib\}:\textbackslash{}\textbackslash{}\$\{DYLD\_LIBRARY\_PATH\}"\textbackslash{}nexport PATH="\textbackslash{}\textbackslash{}\$\{bin\}:\textbackslash{}\textbackslash{}\$\{PATH\}"\textbackslash{}n\textbackslash{}n\# set up required environment variables for librat\textbackslash{}nexport TEST=\textbackslash{}\textbackslash{}\$\{BPMS\}/test/test\_example\textbackslash{}nexport MATLIB=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport RSRLIB=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport ARARAT\_OBJECT=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport DIRECT\_ILLUMINATION=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}nexport BPMS\_FILES=\textbackslash{}\textbackslash{}\$TEST\textbackslash{}n\textbackslash{}nif [ "\textbackslash{}\textbackslash{}\$(which start)" == "\textbackslash{}\textbackslash{}\$\{bin\}/start" ]\textbackslash{}nthen\textbackslash{}n  if [ "\textbackslash{}\textbackslash{}\$VERBOSE" ]; then\textbackslash{}n      echo "start found ok"\textbackslash{}n  fi\textbackslash{}nelse\textbackslash{}n  \# we should create them\textbackslash{}n  make clean all \textbackslash{}nfi\textbackslash{}nEOF\textbackslash{}n\textbackslash{}n\# set executable mode\textbackslash{}nchmod +x \$outfile\textbackslash{}n\# test run\textbackslash{}n\$outfile\textbackslash{}n'' returned non-zero exit status 2.
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}

The object code line:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{usemtl} \PYG{n}{white}
\end{sphinxVerbatim}

tells \sphinxcode{\sphinxupquote{librat}} to load the material named \sphinxcode{\sphinxupquote{white}}. Since we defined that in \sphinxcode{\sphinxupquote{\textasciigrave{}plants.matlib}} \textless{}test/test\_examples/plants.matlib\textgreater{}\textasciigrave{}\_\_ as type \sphinxcode{\sphinxupquote{srm}} with spectral file \sphinxcode{\sphinxupquote{\textasciigrave{}refl/white.dat}} \textless{}test/test\_examples/refl/white.dat\textgreater{}\textasciigrave{}\_\_, the material will have a Lambertian reflectance of \sphinxcode{\sphinxupquote{1.0}} for all (up to 10000 units) wavelengths.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} test/test\PYGZus{}examples/white.dat}
\PYG{l+s}{1 1.0}
\PYG{l+s}{1000 1.0}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
mtllib plants.matlib
usemtl white
v 0 0 0
v 0 0 1
plane \PYGZhy{}1 \PYGZhy{}2
!\PYGZob{}
usemtl white
!\PYGZob{}
v 0 0 1000
ell \PYGZhy{}1 30000 30000 1000
!\PYGZcb{}
!\PYGZcb{}
\end{sphinxVerbatim}

The fields starting \sphinxcode{\sphinxupquote{v}} in \sphinxcode{\sphinxupquote{\textasciigrave{}test/test\_examples/first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_ denote a vertex (vector) (as in the standard wavefront format). This requires 3 numbers to be given after the \sphinxcode{\sphinxupquote{v}} giving the \{x,y,z\} coordinates of the vector. Note that \sphinxcode{\sphinxupquote{v}} fields can specify a \sphinxstyleemphasis{location} or \sphinxstyleemphasis{direction} vector.

The fields \sphinxcode{\sphinxupquote{plane}} and \sphinxcode{\sphinxupquote{ell}} specify scene objects. We will look at a fuller range of such objects later, but these two allow for a simple scene specification. plane is an infinite planar object. It is defined by an intersection point (location vector) \sphinxcode{\sphinxupquote{I}} and a direction vector \sphinxcode{\sphinxupquote{N}}. These vectors need to be defined before a call is made to the object, so in this case, we define \sphinxcode{\sphinxupquote{I}} as \sphinxcode{\sphinxupquote{0 0 0}} and \sphinxcode{\sphinxupquote{N}} as \sphinxcode{\sphinxupquote{0 0 1}}, i.e.Â an x\sphinxhyphen{}y plane at z=0.

Thus \sphinxcode{\sphinxupquote{plane \sphinxhyphen{}1 \sphinxhyphen{}2}} means â€˜define a plane with \sphinxcode{\sphinxupquote{N}} given by the previous (\sphinxcode{\sphinxupquote{\sphinxhyphen{}1}}) specified vector that goes through \sphinxcode{\sphinxupquote{I}} given by the second to last specified vector (\sphinxcode{\sphinxupquote{\sphinxhyphen{}2}}).â€™

\sphinxcode{\sphinxupquote{ell}} is an ellipsoid object. Its description requires definition of:
\begin{itemize}
\item {} 
the base (N.B. not the centre) of the ellipsoid (\sphinxcode{\sphinxupquote{\sphinxhyphen{}1}} here, meaning the previously\sphinxhyphen{}defined vector \sphinxhyphen{} \sphinxcode{\sphinxupquote{0 0 1000}} in this case);

\item {} 
the semi\sphinxhyphen{}axis lengths in \sphinxcode{\sphinxupquote{x,y,z}} directions (\sphinxcode{\sphinxupquote{30000 30000 1000}} here).

\end{itemize}

so:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{v} \PYG{l+m+mi}{0} \PYG{l+m+mi}{0} \PYG{l+m+mi}{1000}
\PYG{n}{ell} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1} \PYG{l+m+mi}{30000} \PYG{l+m+mi}{30000} \PYG{l+m+mi}{1000}
\end{sphinxVerbatim}

is in fact a spheroid of x\sphinxhyphen{}y semi\sphinxhyphen{}axis length 30000 units (arbitrary linear units) and z\sphinxhyphen{}semi\sphinxhyphen{}axis length 1000 units: a \sphinxstyleemphasis{prolate} spheroid that extends from \sphinxcode{\sphinxupquote{\sphinxhyphen{}30000}} to \sphinxcode{\sphinxupquote{30000}} in the x\sphinxhyphen{} and y\sphinxhyphen{}directions and from \sphinxcode{\sphinxupquote{1000}} to \sphinxcode{\sphinxupquote{3000}} in the z\sphinxhyphen{}direction. Not that the physical unit for these dimensions is arbitrary, but must be consistent throughout.

The fields \sphinxcode{\sphinxupquote{!\{}} and \sphinxcode{\sphinxupquote{!\}}} in \sphinxcode{\sphinxupquote{\textasciigrave{}test/test\_examples/first.obj}} \textless{}test/test\_examples/first.obj\textgreater{}\textasciigrave{}\_\_ specify that a bounding box should be placed around objects contained within the brackets. This allows for efficient intersection tests in the ray tracing.

We now want to use the code \sphinxcode{\sphinxupquote{start}} to run \sphinxcode{\sphinxupquote{librat}} functionality.

If you have compiled the code, the executable and library should be in the directory \sphinxcode{\sphinxupquote{\textasciigrave{}src}} \textless{}src\textgreater{}\textasciigrave{}\_\_ as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{src}\PYG{o}{/}\PYG{n}{start}
\PYG{n}{src}\PYG{o}{/}\PYG{n}{libratlib}\PYG{o}{.}\PYG{p}{[}\PYG{n}{dll}\PYG{p}{,}\PYG{n}{so}\PYG{p}{]}
\end{sphinxVerbatim}

The suffix for the library will be \sphinxcode{\sphinxupquote{dll}} on windows, and \sphinxcode{\sphinxupquote{so}} on other operating systems. Lets just check they are there:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nv}{lib}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}./src\PYGZsq{}}
\PYG{n+nv}{bin}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}./src\PYGZsq{}}

ls \PYGZhy{}l \PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{lib}\PYG{l+s+si}{\PYGZcb{}}/start \PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{bin}\PYG{l+s+si}{\PYGZcb{}}/libratlib.*
\end{sphinxVerbatim}
}

Donâ€™t worry too much if its not there as we can make it when we need it.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} shell preamble}
\PYG{c+c1}{\PYGZsh{}}

\PYG{c+c1}{\PYGZsh{} set shell variables lib, bin, verbose}
\PYG{c+c1}{\PYGZsh{} with defaults in case not set}
\PYG{n+nv}{lib}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{lib}\PYG{p}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}./src\PYGZsq{}}\PYG{l+s+si}{\PYGZcb{}}
\PYG{n+nv}{bin}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{bin}\PYG{p}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}./src\PYGZsq{}}\PYG{l+s+si}{\PYGZcb{}}
\PYG{n+nv}{verbose}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{verbose}\PYG{p}{\PYGZhy{}1}\PYG{l+s+si}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} set up required environment variables for bash}
\PYG{n+nb}{export} \PYG{n+nv}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{lib}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{export} \PYG{n+nv}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{lib}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{export} \PYG{n+nv}{PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{bin}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{:}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{PATH}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} set up required environment variables for librat}
\PYG{n+nb}{export} \PYG{n+nv}{TEST}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{l+s+si}{\PYGZcb{}}/test/test\PYGZus{}example
\PYG{n+nb}{export} \PYG{n+nv}{MATLIB}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}TEST}
\PYG{n+nb}{export} \PYG{n+nv}{RSRLIB}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}TEST}
\PYG{n+nb}{export} \PYG{n+nv}{ARARAT\PYGZus{}OBJECT}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}TEST}
\PYG{n+nb}{export} \PYG{n+nv}{DIRECT\PYGZus{}ILLUMINATION}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}TEST}
\PYG{n+nb}{export} \PYG{n+nv}{BPMS\PYGZus{}FILES}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}TEST}

\PYG{k}{if} \PYG{o}{[} \PYG{k}{\PYGZdl{}(}which start\PYG{k}{)} \PYG{o}{=}\PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}./src/start\PYGZsq{}} \PYG{o}{]}
\PYG{k}{then}
  \PYG{k}{if} \PYG{o}{[} \PYG{n+nv}{\PYGZdl{}verbose} \PYG{o}{]}\PYG{p}{;} \PYG{k}{then}
      \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}start found ok\PYGZdq{}}
  \PYG{k}{fi}
\PYG{k}{else}
  \PYG{c+c1}{\PYGZsh{} we should create them}
  make clean all
\PYG{k}{fi}
\end{sphinxVerbatim}
}


\section{Object example 2: clones}
\label{\detokenize{Chapter2:Object-example-2:-clones}}

\bigskip\hrule\bigskip


{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} test/test\PYGZus{}examples/second.obj}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{mtllib plants.matlib}
\PYG{l+s}{v 0.000000 0.000000 0.000000}
\PYG{l+s}{v 0.000000 0.000000 1.000000}
\PYG{l+s}{usemtl full}
\PYG{l+s}{plane \PYGZhy{}1 \PYGZhy{}2}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{\PYGZsh{}define}
\PYG{l+s}{g object 0}
\PYG{l+s}{usemtl half}
\PYG{l+s}{v 0 0 0}
\PYG{l+s}{v 0 0 1}
\PYG{l+s}{cyl \PYGZhy{}1 \PYGZhy{}2 0.1}
\PYG{l+s}{sph \PYGZhy{}1 0.2}
\PYG{l+s}{v \PYGZhy{}1 0 1}
\PYG{l+s}{cyl \PYGZhy{}1 \PYGZhy{}2 0.1}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{clone 0 0 0 0 object 0}
\PYG{l+s}{clone 0 1 0 90 object 0}
\PYG{l+s}{clone \PYGZhy{}1 0 0 \PYGZhy{}90 object 0}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}


\chapter{Appendix 1: \sphinxstyleliteralintitle{\sphinxupquote{bash}} help}
\label{\detokenize{Appendix1:Appendix-1:-bash-help}}\label{\detokenize{Appendix1::doc}}
To use \sphinxcode{\sphinxupquote{librat}}, we need to have a passing awareness of some computer system settings called \sphinxhref{https://en.wikipedia.org/wiki/Environment\_variable}{environment variables}. We do this in this chapter, alongside a few other basic linux/unix commands that may be useful to know.

In practical terms, the important thing here is that you can generate the file \sphinxcode{\sphinxupquote{test/test\_examples/init.sh}} and modify it to your needs. The rest you can skip for now, if you really want to. But you may well find yourself returning to this chapter when you want to ask more of your computer and of this tool.

Our focus will be on \sphinxhref{https://opensource.com/article/19/8/what-are-environment-variables}{bash} environment variables.

This chapter is not generally critical for understanding \sphinxcode{\sphinxupquote{librat}} but may help if you go into any details on your setup, or have problems.

The chapter covers:
\begin{itemize}
\item {} 
Introduction to shell and environment variables

\item {} 
Some important environment variables and related

\item {} 
Important environment variables for librat

\end{itemize}


\section{Introduction to shell and environment variables}
\label{\detokenize{Appendix1:Introduction-to-shell-and-environment-variables}}

\subsection{\sphinxstyleliteralintitle{\sphinxupquote{export}}}
\label{\detokenize{Appendix1:export}}
An \sphinxstylestrong{environment variable} is one that is passed through from a shell to any child processes.

We can recognise these as they are usually defined in upper case (capital letters), and (in bash) defined with a \sphinxcode{\sphinxupquote{export}} command: e.g.:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{export} \PYG{n}{MATLIB}\PYG{o}{=}\PYG{n}{test}\PYG{o}{/}\PYG{n}{test\PYGZus{}examples}
\end{sphinxVerbatim}

In this case, this would set the environment variable called \sphinxcode{\sphinxupquote{MATLIB}} to \sphinxcode{\sphinxupquote{test/test\_examples}}. The syntax is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{export} \PYG{n}{NAME}\PYG{o}{=}\PYG{n}{value}
\end{sphinxVerbatim}


\subsection{White space and single quotes \sphinxstyleliteralintitle{\sphinxupquote{\textquotesingle{}}}}
\label{\detokenize{Appendix1:White-space-and-single-quotes-'}}
If \sphinxcode{\sphinxupquote{value}} has white space (gaps in the name), it will need quotes to contain the string, e.g.:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{export} \PYG{n}{SOMEHWERE}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C:/Program Files}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

Here, we contain the string \sphinxcode{\sphinxupquote{C:/Program Files}}, which has white space, in single quotes (\sphinxcode{\sphinxupquote{\textquotesingle{}}}). Its a good idea to avoid white space in filenames as they can cause problems. Use dash \sphinxcode{\sphinxupquote{\sphinxhyphen{}}} or underscore \sphinxcode{\sphinxupquote{\_}} instead.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{echo}}}
\label{\detokenize{Appendix1:echo}}
We can see the value a variable is set to with the command \sphinxcode{\sphinxupquote{echo}}, and refer to the \sphinxstyleemphasis{value} of a variable with a \sphinxcode{\sphinxupquote{\$}} symbol e.g.:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[1]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{export} \PYG{n+nv}{MATLIB}\PYG{o}{=}test/test\PYGZus{}examples
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MATLIB is set to }\PYG{n+nv}{\PYGZdl{}MATLIB}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
MATLIB is set to test/test\_examples
\end{sphinxVerbatim}
}

Note that there must be no gaps in \sphinxcode{\sphinxupquote{NAME=value}} part of the statement. That is a typical thing for new users to get wrong and which can cause problems.


\subsection{Double quotes \sphinxstyleliteralintitle{\sphinxupquote{"}} and backslash escape \sphinxstyleliteralintitle{\sphinxupquote{/}}}
\label{\detokenize{Appendix1:Double-quotes-"-and-backslash-escape-/}}
If you want to replace the value of a variable in a string, then you should generally use double quotes (\sphinxcode{\sphinxupquote{"}}) instead of single quotes \sphinxcode{\sphinxupquote{\textquotesingle{}}} as above:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[2]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{export} \PYG{n+nv}{MATLIB}\PYG{o}{=}test/test\PYGZus{}examples

\PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}1. MATLIB is set to \PYGZdl{}MATLIB in single quotes\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2. MATLIB is set to }\PYG{n+nv}{\PYGZdl{}MATLIB}\PYG{l+s+s2}{ in double quotes}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}2. MATLIB is set to \PYGZbs{}\PYGZdl{}MATLIB in double quotes but with \PYGZbs{} escaping the \PYGZbs{}\PYGZdl{}\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. MATLIB is set to \$MATLIB in single quotes
2. MATLIB is set to test/test\_examples in double quotes
2. MATLIB is set to \$MATLIB in double quotes but with \textbackslash{} escaping the \$
\end{sphinxVerbatim}
}

However, we can also â€˜escapeâ€™ the interpretation of the \sphinxcode{\sphinxupquote{\$}} symbol in the double quoted string, with the backslash \sphinxhref{https://www.shellscript.sh/escape.html}{escape symbol} \sphinxcode{\sphinxupquote{\textbackslash{}}}, as in example 3.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{env}}, \sphinxstyleliteralintitle{\sphinxupquote{grep}}, pipe \sphinxstyleliteralintitle{\sphinxupquote{|}}}
\label{\detokenize{Appendix1:env,-grep,-pipe-|}}
To see the values of all environment variables, type \sphinxcode{\sphinxupquote{env}} (or \sphinxcode{\sphinxupquote{printenv}}). Because this list can be quite long, we might want to select only certain lines from the list. One way to do this is to use the command \sphinxhref{https://en.wikipedia.org/wiki/Grep}{grep}, which searches for patterns in the each line:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[3]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{export} \PYG{n+nv}{MATLIB}\PYG{o}{=}test/test\PYGZus{}examples

env \PYG{p}{|} grep M
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
TERM\_PROGRAM=Apple\_Terminal
TERM=xterm-color
TMPDIR=/var/folders/mp/9cxd5s793bjd4q3zng6dv\_cw0000gn/T/
CONDA\_PROMPT\_MODIFIER=(librat)
TERM\_PROGRAM\_VERSION=433
GSETTINGS\_SCHEMA\_DIR\_CONDA\_BACKUP=
TERM\_SESSION\_ID=7FC61198-BCF5-4CED-8B68-076E150723FD
KERNEL\_LAUNCH\_TIMEOUT=40
MATLIB=test/test\_examples
PATH=/Users/plewis/opt/anaconda3/envs/librat/bin:/Users/plewis/opt/anaconda3/condabin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Applications/VMware Fusion.app/Contents/Public:/opt/X11/bin:/Library/Apple/usr/bin
GSETTINGS\_SCHEMA\_DIR=/Users/plewis/opt/anaconda3/envs/librat/share/glib-2.0/schemas
MPLBACKEND=module://ipykernel.pylab.backend\_inline
\_CE\_M=
XPC\_SERVICE\_NAME=0
HOME=/Users/plewis
LOGNAME=plewis
\end{sphinxVerbatim}
}

Here, we \sphinxhref{https://en.wikipedia.org/wiki/Pipeline\_(Unix)}{â€˜pipeâ€™} the output of the command \sphinxcode{\sphinxupquote{env}} into the command \sphinxcode{\sphinxupquote{grep}} with the pipe symbol \sphinxcode{\sphinxupquote{|}}. \sphinxcode{\sphinxupquote{grep M}} will filter only lines containing the character \sphinxcode{\sphinxupquote{M}}. We see that this includes the variable \sphinxcode{\sphinxupquote{MATLIB}} that we have set.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{EXERCISE}

\PYG{l+m+mf}{1.} \PYG{n}{Try} \PYG{n}{removing} \PYG{n}{the} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{| grep M}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{above} \PYG{n}{to} \PYG{n}{see} \PYG{n}{the} \PYG{n}{full} \PYG{n+nb}{list} \PYG{n}{of} \PYG{n}{environment} \PYG{n}{variables}\PYG{o}{.}
\PYG{l+m+mf}{2.} \PYG{n}{Try} \PYG{n}{some} \PYG{n}{other} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{grep}\PYG{l+s+s1}{\PYGZsq{}} \PYG{n}{filters}\PYG{p}{,} \PYG{n}{such} \PYG{k}{as} \PYG{n}{filtering} \PYG{n}{lines} \PYG{n}{containing} \PYG{n}{the} \PYG{n}{string} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PATH}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}


\subsection{Shell variable}
\label{\detokenize{Appendix1:Shell-variable}}
A \sphinxstylestrong{shell variable} is one that is \sphinxstyleemphasis{not} passed through from a shell to any child processes. It is only relevant to the shell it is run in.

These are sometimes set as lower case variables (to distinguish from environment variables). The syntax is similar to that of the environment variable, but without the \sphinxcode{\sphinxupquote{export}}. The syntax is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{name}\PYG{o}{=}\PYG{n}{value}
\end{sphinxVerbatim}

for example:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[4]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nv}{hello}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{hello world }\PYG{n+nv}{\PYGZdl{}USER}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}hello}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
hello world plewis
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{set}}, \sphinxstyleliteralintitle{\sphinxupquote{head}} , \sphinxstyleliteralintitle{\sphinxupquote{tail}}}
\label{\detokenize{Appendix1:set,-head-,-tail}}
We can see the values of shell variables with the \sphinxcode{\sphinxupquote{set}} command.

Like \sphinxcode{\sphinxupquote{env}}, this is likely to produce a long list. We could filter as above, with \sphinxcode{\sphinxupquote{grep}}, or here, we use \sphinxcode{\sphinxupquote{tail}} to take the \sphinxstyleemphasis{last} \sphinxcode{\sphinxupquote{N}} lines produced or \sphinxcode{\sphinxupquote{head}} for the first \sphinxcode{\sphinxupquote{N}} lines. The syntax is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{head} \PYG{o}{\PYGZhy{}}\PYG{n}{N}
\PYG{n}{tail} \PYG{o}{\PYGZhy{}}\PYG{n}{N}
\end{sphinxVerbatim}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[5]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}1. The first 5 shell variables ...\PYGZdq{}}
\PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsq{}}
\PYG{n+nb}{set} \PYG{p}{|} head \PYGZhy{}5
\PYG{n+nb}{echo}

\PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}2. The last 5 shell variables ...\PYGZdq{}}
\PYG{n+nb}{echo} \PYG{l+s+s1}{\PYGZsq{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZsq{}}
\PYG{n+nb}{set} \PYG{p}{|} tail \PYGZhy{}5
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
--------------------
1. The first 5 shell variables {\ldots}
--------------------
BASH=/bin/bash
BASH\_ARGC=()
BASH\_ARGV=()
BASH\_LINENO=()
BASH\_SOURCE=()

--------------------
2. The last 5 shell variables {\ldots}
--------------------
XPC\_SERVICE\_NAME=0
\_=--------------------
\_CE\_CONDA=
\_CE\_M=
\_\_CF\_USER\_TEXT\_ENCODING=0x1F5:0:2
\end{sphinxVerbatim}
}


\section{Some important environment variables and related}
\label{\detokenize{Appendix1:Some-important-environment-variables-and-related}}
When running \sphinxstyleemphasis{any} code, we should be aware of the following shell environment variables:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PATH}
\PYG{n}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}
\PYG{n}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}
\end{sphinxVerbatim}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{PATH}}}
\label{\detokenize{Appendix1:PATH}}
\sphinxhref{https://opensource.com/article/17/6/set-path-linux}{\$PATH} tells the \sphinxhref{https://www.gnu.org/software/bash/}{shell} where to look for executable files (codes that it can run). This is simply a list of locations (directories) in the computer file system that the shell will look. Elements of the list are separated by \sphinxcode{\sphinxupquote{:}}. so, if for example we have the \sphinxcode{\sphinxupquote{PATH}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}

and tell the shell to run an executable called \sphinxhref{https://en.wikipedia.org/wiki/Ls}{ls}, then it will first look in \sphinxcode{\sphinxupquote{/usr/local/bin}}, then \sphinxcode{\sphinxupquote{/usr/bin}} and so on, until it finds \sphinxcode{\sphinxupquote{ls}}.

We have used double quotes \sphinxcode{\sphinxupquote{"}} around the variable, in case any of the elements had white space (they donâ€™t here).


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{which}}}
\label{\detokenize{Appendix1:which}}
We can see which one it finds with the command \sphinxhref{https://en.wikipedia.org/wiki/Which\_(command)}{which}:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[6]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

which ls
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/bin/ls
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{ls}}}
\label{\detokenize{Appendix1:ls}}
As we saw above, \sphinxhref{https://en.wikipedia.org/wiki/Ls}{ls} gives a listing of files and directories. If we use the \sphinxcode{\sphinxupquote{\sphinxhyphen{}C}} option, it outputs multiple columns of information, which is handy if there are lots of entries.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[7]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} get a listing of the current directory, just to see whats here}
ls \PYGZhy{}C
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Appendix1.ipynb                 default.profraw
Chapter1.ipynb                  index.rst
Chapter2.ipynb                  ipython\_kernel\_config.py
\_static                                references.bib
\_templates                     requirements.txt
conf.py                         test
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{.bash\_profile}}, \sphinxstyleliteralintitle{\sphinxupquote{.bashrc}}, wildcard \sphinxstyleliteralintitle{\sphinxupquote{*}}}
\label{\detokenize{Appendix1:.bash_profile,-.bashrc,-wildcard-*}}
These core environment variables are usually set with default values appropriate to your system. This may be done in \sphinxhref{https://www.gnu.org/software/bash/manual/html\_node/Bash-Startup-Files.html}{system\sphinxhyphen{}wide files such as /etc/profile, or personal files} such as \sphinxcode{\sphinxupquote{\textasciitilde{}/.bashrc}} or \sphinxcode{\sphinxupquote{\textasciitilde{}/.bash\_profile}}, where \sphinxcode{\sphinxupquote{\textasciitilde{}}} is the symbol for your home directory. This will almost certainly set \sphinxcode{\sphinxupquote{\$PATH}}.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[8]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}d \PYGZhy{}\PYGZgt{} no directories}

ls \PYGZhy{}Cd  \PYGZti{}/.bash*
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/Users/plewis/.bash\_history
/Users/plewis/.bash\_profile
/Users/plewis/.bash\_profile-anaconda3.bak
/Users/plewis/.bash\_profile.backup
/Users/plewis/.bash\_sessions
\end{sphinxVerbatim}
}

above, we use the wildcard symbol \sphinxcode{\sphinxupquote{*}}, interpreted by the shell as any file matching the pattern \sphinxcode{\sphinxupquote{\textasciitilde{}/.bash*}} with \sphinxcode{\sphinxupquote{*}} being zero or more characters. The \sphinxcode{\sphinxupquote{\textasciitilde{}}} is matched to the userâ€™s home directory name in this case.

For many purposes, the default options to \sphinxcode{\sphinxupquote{ls}} will do. The \sphinxcode{\sphinxupquote{\sphinxhyphen{}C}} option we would hardly use, but is useful above for better note formatting. The \sphinxcode{\sphinxupquote{\sphinxhyphen{}d}} option is again rarely used, but useful in this case as we only want to see files in the home directory.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{ls \sphinxhyphen{}l}}}
\label{\detokenize{Appendix1:ls--l}}
One useful option to \sphinxcode{\sphinxupquote{ls}} is \sphinxcode{\sphinxupquote{\sphinxhyphen{}l}}, that gives â€˜long listingâ€™:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[9]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}d \PYGZhy{}\PYGZgt{} no directories}

ls \PYGZhy{}lhd  \PYGZti{}/.bash*
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
-rw-------    1 plewis  staff    27K 17 Apr 18:32 /Users/plewis/.bash\_history
-rw-r--r--    1 plewis  staff   3.0K 17 Apr 17:00 /Users/plewis/.bash\_profile
-rw-r--r--    1 plewis  staff   1.1K 15 Jul  2019 /Users/plewis/.bash\_profile-anaconda3.bak
-rw-r--r--    1 plewis  staff   727B 15 Jul  2019 /Users/plewis/.bash\_profile.backup
drwx------  108 plewis  staff   3.4K  2 Feb 14:42 /Users/plewis/.bash\_sessions
\end{sphinxVerbatim}
}

The \sphinxcode{\sphinxupquote{\sphinxhyphen{}l}} option gives the file sizes and other useful information in this â€˜longâ€™ listing. The file sizes here are given in \sphinxcode{\sphinxupquote{K}} or other human\sphinxhyphen{}readable (\textasciicircum{}3) units, as we have set the \sphinxcode{\sphinxupquote{\sphinxhyphen{}h}} option. Many unix commands that involve file sizes will have a similar \sphinxcode{\sphinxupquote{\sphinxhyphen{}h}} option.

The first set of information, such as \sphinxcode{\sphinxupquote{\sphinxhyphen{}rw\sphinxhyphen{}r\sphinxhyphen{}\sphinxhyphen{}r\sphinxhyphen{}\sphinxhyphen{}}} gives us information on file permissions. It represents a 10\sphinxhyphen{}bit field, where bits are set â€˜onâ€™ (1) or off (0). After the first bit (the sticky bit), the fields are 3 sets of 3\sphinxhyphen{}bit fields (so, octal \sphinxhyphen{} base 8 = 2\textasciicircum{}3). These 3 bits represent \sphinxcode{\sphinxupquote{rwx}}, with
\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{r}}: read permission

\item {} 
\sphinxcode{\sphinxupquote{w}}: write permission

\item {} 
\sphinxcode{\sphinxupquote{x}}: execute permission

\end{itemize}

So:
\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{rw\sphinxhyphen{}}} means that permission is set for reading the file and writing to it

\item {} 
\sphinxcode{\sphinxupquote{r\sphinxhyphen{}\sphinxhyphen{}}} means reading but not writing

\item {} 
\sphinxcode{\sphinxupquote{rwx}} means reading, writing and execute

\end{itemize}

The first set of 3 bits represents permissions for the file owner, the second for users in the same group, and the third for all users (others).

So:
\begin{itemize}
\item {} 
\sphinxcode{\sphinxupquote{\sphinxhyphen{}rw\sphinxhyphen{}r\sphinxhyphen{}\sphinxhyphen{}r\sphinxhyphen{}\sphinxhyphen{}}} means read and write for the owner, but only read permission for group and all. This is the typical setting for a non\sphinxhyphen{}executable file: everyone can read it, but only the owner can write. In octal, this is 644.

\item {} 
\sphinxcode{\sphinxupquote{\sphinxhyphen{}rwxr\sphinxhyphen{}xr\sphinxhyphen{}x}} means read, write and execute for the owner, and read and execute permission for others. This is the typical setting for an executable file: everyone can execute it and read it, but only the owner can write. In octal, this is 755.

\end{itemize}

In fact, the final â€˜bitâ€™, known as the \sphinxhref{https://en.wikipedia.org/wiki/Sticky\_bit}{sticky bit} can have more settings than just \sphinxcode{\sphinxupquote{\sphinxhyphen{}}} or \sphinxcode{\sphinxupquote{x}}, but we need not worry about that here.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{chmod}}, \sphinxstyleliteralintitle{\sphinxupquote{\textgreater{}}}, \sphinxstyleliteralintitle{\sphinxupquote{rm \sphinxhyphen{}f}}, \sphinxstyleliteralintitle{\sphinxupquote{mkdir \sphinxhyphen{}p}}}
\label{\detokenize{Appendix1:chmod,->,-rm--f,-mkdir--p}}
We can change the file permissions, using the command \sphinxhref{https://en.wikipedia.org/wiki/Chmod}{chmod}. Most typically, we use options such as \sphinxcode{\sphinxupquote{+x}} to add an executable bit, or \sphinxcode{\sphinxupquote{go\sphinxhyphen{}r}} to remove read permissions (for group and other, here).

We create a file in a directory \sphinxcode{\sphinxupquote{files.\$\$}}, where \sphinxcode{\sphinxupquote{\$\$}} is the \sphinxhref{https://en.wikipedia.org/wiki/Process\_identifier}{shell process ID} which we can use to give probably a unique directory name (i.e.Â one very unlikely to be created by any other process). First, we must create (make) the directory if it doesnâ€™t already exist. This is done with \sphinxcode{\sphinxupquote{mkdir \sphinxhyphen{}p}}. The \sphinxcode{\sphinxupquote{\sphinxhyphen{}p}} option will not fail if the directory alreay exists, and also will create any depth of directories specified.

The file is called \sphinxcode{\sphinxupquote{files/hello.dat}} and is created by \sphinxhref{https://en.wikipedia.org/wiki/Redirection\_(computing)}{redirecting the standard output} (\sphinxcode{\sphinxupquote{stdout}}) of a command to a file, i.e.Â sending the text coming from \sphinxcode{\sphinxupquote{echo "hello world"}} into the file. The symbol for redirection of \sphinxcode{\sphinxupquote{stdout}} is \sphinxcode{\sphinxupquote{\textgreater{}}}. This redirection is the same process used above when we redirected output to a pipe.

Just in case the file already exists, and we have previously messed around with the file permissions, we first run the command \sphinxcode{\sphinxupquote{rm \sphinxhyphen{}f}} to delete (remove) the file. The \sphinxcode{\sphinxupquote{\sphinxhyphen{}f}} option tells us to â€˜forceâ€™ this, regardless of the fileâ€™s permissions or whether the file already exists. At the end of the shell, we use \sphinxcode{\sphinxupquote{rm \sphinxhyphen{}rf}} to delete the directory and anythinbg in it (a recursice delete).

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[10]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} create a unique directory name}
\PYG{n+nv}{dir}\PYG{o}{=}/tmp/files.\PYG{n+nv}{\PYGZdl{}\PYGZdl{}}

\PYG{c+c1}{\PYGZsh{} make directory}
mkdir \PYGZhy{}p \PYG{n+nv}{\PYGZdl{}dir}

\PYG{c+c1}{\PYGZsh{} force delete the file, in case it exists}
rm \PYGZhy{}f \PYG{n+nv}{\PYGZdl{}dir}/hello.dat

\PYG{c+c1}{\PYGZsh{} generate the file}
\PYG{c+c1}{\PYGZsh{} it should contain 11 characters (bytes) plus}
\PYG{c+c1}{\PYGZsh{} an End Of File (EOF) character (\PYGZca{}D), so 12B}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}hello world\PYGZdq{}} \PYGZgt{} \PYG{n+nv}{\PYGZdl{}dir}/hello.dat

\PYG{c+c1}{\PYGZsh{} listing}
\PYG{c+c1}{\PYGZsh{} The default permission should be rw\PYGZhy{}r\PYGZhy{}\PYGZhy{}r\PYGZhy{}\PYGZhy{}}
ls \PYGZhy{}lh \PYG{n+nv}{\PYGZdl{}dir}/hello.dat

\PYG{c+c1}{\PYGZsh{} We now remove the read permissions using chmod}
\PYG{c+c1}{\PYGZsh{} The permission should be rw\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
chmod go\PYGZhy{}r \PYG{n+nv}{\PYGZdl{}dir}/hello.dat
ls \PYGZhy{}lh \PYG{n+nv}{\PYGZdl{}dir}/hello.dat

\PYG{c+c1}{\PYGZsh{} now add user execute}
chmod u+x \PYG{n+nv}{\PYGZdl{}dir}/hello.dat
ls \PYGZhy{}lh \PYG{n+nv}{\PYGZdl{}dir}/hello.dat

\PYG{c+c1}{\PYGZsh{} clean up after ourselves}
\PYG{c+c1}{\PYGZsh{} remove everything in files.\PYGZdl{}\PYGZdl{}, along with the directory}
rm \PYGZhy{}rf \PYG{n+nv}{\PYGZdl{}dir}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
-rw-r--r--  1 plewis  wheel    12B 18 Apr 20:41 /tmp/files.88512/hello.dat
-rw-------  1 plewis  wheel    12B 18 Apr 20:41 /tmp/files.88512/hello.dat
-rwx------  1 plewis  wheel    12B 18 Apr 20:41 /tmp/files.88512/hello.dat
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{cat}}}
\label{\detokenize{Appendix1:cat}}
We can use the command \sphinxhref{https://en.wikipedia.org/wiki/Cat\_(Unix)}{cat} to create or to â€˜viewâ€™ the contents of a file. For example, the command:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cat} \PYG{o}{\PYGZti{}}\PYG{o}{/}\PYG{o}{.}\PYG{n}{bash\PYGZus{}profile}
\end{sphinxVerbatim}

would â€˜printâ€™ (send to the terminal, rather) the contents of the file \sphinxcode{\sphinxupquote{\textasciitilde{}/.bash\_profile}}.

Since this may be quite long, we will use \sphinxcode{\sphinxupquote{head}} just to see the first \sphinxcode{\sphinxupquote{N}} lines:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[11]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

cat \PYGZti{}/.bash\PYGZus{}profile \PYG{p}{|} head \PYGZhy{}5
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\# added by Anaconda3 2019.03 installer
\# >>> conda init >>>
\# !! Contents within this block are managed by 'conda init' !!
\_\_conda\_setup="\$(CONDA\_REPORT\_ERRORS=false '/anaconda3/bin/conda' shell.bash hook 2> /dev/null)"
if [ \$? -eq 0 ]; then
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{pwd}}, \sphinxstyleliteralintitle{\sphinxupquote{cd}}}
\label{\detokenize{Appendix1:pwd,-cd}}
The command \sphinxcode{\sphinxupquote{pwd}} returns the \sphinxhref{https://en.wikipedia.org/wiki/Pwd}{current working directory}. This is extremely useful to know, especially as new users often get lost in a shell on the file system. To find out where you are, in a shell, type:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pwd}
\end{sphinxVerbatim}

This will return the â€˜locationâ€™ you are at in that shell.

The command \sphinxcode{\sphinxupquote{cd}} is used to change directory. The syntax is:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cd} \PYG{n}{location}
\end{sphinxVerbatim}

where \sphinxcode{\sphinxupquote{location}} is somewhere on the file system.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[12]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash


\PYG{n+nb}{echo} \PYGZhy{}n \PYG{l+s+s2}{\PYGZdq{}where am I now?: \PYGZdq{}}
\PYG{n+nb}{pwd}

\PYG{c+c1}{\PYGZsh{} go home using \PYGZsq{}cd \PYGZti{}\PYGZsq{}\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}go home (\PYGZti{}): \PYGZdq{}}
\PYG{n+nb}{cd} \PYGZti{}
\PYG{n+nb}{echo} \PYGZhy{}n \PYG{l+s+s2}{\PYGZdq{}where am I now?: \PYGZdq{}}
\PYG{n+nb}{pwd}

\PYG{c+c1}{\PYGZsh{} go to directory librat \PYGZsq{}cd librat\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}go to librat: \PYGZdq{}}
\PYG{n+nb}{cd} librat
\PYG{n+nb}{echo} \PYGZhy{}n \PYG{l+s+s2}{\PYGZdq{}where am I now?: \PYGZdq{}}
\PYG{n+nb}{pwd}

\PYG{c+c1}{\PYGZsh{} go to directory librat \PYGZsq{}cd \PYGZti{}/librat\PYGZsq{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}go to \PYGZti{}/librat: \PYGZdq{}}
\PYG{n+nb}{cd} \PYGZti{}/librat
\PYG{n+nb}{echo} \PYGZhy{}n \PYG{l+s+s2}{\PYGZdq{}where am I now?: \PYGZdq{}}
\PYG{n+nb}{pwd}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
where am I now?: /Users/plewis/librat/docs/source
go home (\textasciitilde{}):
where am I now?: /Users/plewis
go to librat:
where am I now?: /Users/plewis/librat
go to \textasciitilde{}/librat:
where am I now?: /Users/plewis/librat
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{\$(pwd)}}}
\label{\detokenize{Appendix1:_(pwd)}}
Sometimes we want to set a variable to the result returned by running an executable. For example, the command \sphinxcode{\sphinxupquote{pwd}} returns the \sphinxhref{https://en.wikipedia.org/wiki/Pwd}{current working directory}. We can set a variable to this, with the following example syntax:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
PWD=\PYGZdl{}(pwd)
\end{sphinxVerbatim}

Note the round brackets \sphinxcode{\sphinxupquote{\$()}} enclosing the command (\sphinxcode{\sphinxupquote{pwd}} here).

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[13]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} set PWD to the result of running `pwd`}
\PYG{n+nb}{echo} \PYGZhy{}n \PYG{l+s+s2}{\PYGZdq{}1. Run the command pwd: \PYGZdq{}}
\PYG{n+nb}{pwd}

\PYG{c+c1}{\PYGZsh{} Note the use of \PYGZbs{}\PYGZdl{} in printing here. This will make sure \PYGZdl{} is printed,}
\PYG{c+c1}{\PYGZsh{} rather than \PYGZdl{}(pwd) in this statement}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}2. Set the variable PWD the result of running the command pwd with PWD=\PYGZbs{}\PYGZdl{}(pwd):\PYGZdq{}}

\PYG{n+nv}{PWD}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{3. Now print that out: PWD is set to }\PYG{n+nv}{\PYGZdl{}PWD}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. Run the command pwd: /Users/plewis/librat/docs/source
2. Set the variable PWD the result of running the command pwd with PWD=\$(pwd):
3. Now print that out: PWD is set to /Users/plewis/librat/docs/source
\end{sphinxVerbatim}
}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{\$\{BPMS\sphinxhyphen{}\$(pwd)\}}}}
\label{\detokenize{Appendix1:__BPMS-_(pwd)_}}
In \sphinxcode{\sphinxupquote{bash}} we often use syntax that only sets a valiable if it is not already set. This is done in the example:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
BPMS=\PYGZdl{}\PYGZob{}BPMS\PYGZhy{}\PYGZdl{}(pwd)\PYGZcb{}
\end{sphinxVerbatim}

where some variable \sphinxcode{\sphinxupquote{BPMS}} is set to the result of running \sphinxcode{\sphinxupquote{pwd}}, unless it is already set.

Note the curley brackets in \sphinxcode{\sphinxupquote{\$\{\}}}.

Note that the environment \sphinxcode{\sphinxupquote{BPMS}} is generally used to define the top level directory of \sphinxcode{\sphinxupquote{librat}} codes.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[14]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{}}
\PYG{c+c1}{\PYGZsh{} example using \PYGZdl{}\PYGZob{}BPMS\PYGZhy{}\PYGZdl{}(pwd)\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{}}

\PYG{c+c1}{\PYGZsh{} set BPMS variable to result of pwd, unless its already set}
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}Previous Value\PYGZdq{}}
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1. BPMS set to }\PYG{n+nv}{\PYGZdl{}BPMS}\PYG{l+s+s2}{ because BPMS is set}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} unset the variable, so its no longer set}
\PYG{n+nb}{unset} BPMS
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}
\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2. BPMS set to }\PYG{n+nv}{\PYGZdl{}BPMS}\PYG{l+s+s2}{, from running pwd, because BPMS is not set}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. BPMS set to Previous Value because BPMS is set
2. BPMS set to /Users/plewis/librat/docs/source, from running pwd, because BPMS is not set
\end{sphinxVerbatim}
}


\subsection{edit}
\label{\detokenize{Appendix1:edit}}
If you want to make changes to important environment variables, you would normally edit them in your \sphinxcode{\sphinxupquote{.bash\_profile}} file in your home directory. Here is an exercise to do that. It assumes that you know: (i) the location in the filesystem of your librat distribution; (ii) some text file editor (N.B. \sphinxstylestrong{Not} Microsoft word or similar: that is a word processor, not a text editor!). Examples would be:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxincludegraphics[width=25\sphinxpxdimen,height=25\sphinxpxdimen]{{apple_med}.png}
&\sphinxstyletheadfamily 
\sphinxincludegraphics[width=25\sphinxpxdimen,height=25\sphinxpxdimen]{{win_med}.png}
&\sphinxstyletheadfamily 
\sphinxincludegraphics[width=25\sphinxpxdimen,height=25\sphinxpxdimen]{{linux_med}.png}
\\
\hline
\sphinxhref{https://en.wikipedia.org/wiki/TextEdit}{textedit}
&
\sphinxhref{https://en.wikipedia.org/wiki/Microsoft\_Notepad}{Notepad}
&
\sphinxhref{https://en.wikipedia.org/wiki/Gedit}{gedit}
\\
\hline
\sphinxhref{https://en.wikipedia.org/wiki/Vim\_(text\_editor)}{vi(m)}
&
\sphinxhref{https://en.wikipedia.org/wiki/Vim\_(text\_editor)}{vi(m)}
&
\sphinxhref{https://en.wikipedia.org/wiki/Vim\_(text\_editor)}{vi(m)}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
EXERCISE

    1. Make a copy of your \PYGZti{}/.bash\PYGZus{}profile, just in case you mess things up. Do this only the once!

        cp \PYGZti{}/.bash\PYGZus{}profile \PYGZti{}/.bash\PYGZus{}profile.bak

    If the file doesn\PYGZsq{}t already exist, don\PYGZsq{}t worry about this part

    2. Find out where your librat installation is located e.g. /Users/plewis/librat)

    3. Now, edit the file \PYGZti{}/.bash\PYGZus{}profile and add a line at the end of the file that says (the *equivalent* of):

        export BPMS=/Users/plewis/librat

    where you use the location of your librat distribution.

    4. Save the file and quit the editor.

    5. Open a new shell. At the command prompt, type:

            source \PYGZti{}/.bash\PYGZus{}profile

    Then

            echo \PYGZdl{}BPMS

    It should show the value you set it to.

    999. If you get stuck, or think you have messed up, copy the original bash\PYGZus{}profile file back in place:

        cp \PYGZti{}/.bash\PYGZus{}profile.bak \PYGZti{}/.bash\PYGZus{}profile

    Then source that in a shell:

        source \PYGZti{}/.bash\PYGZus{}profile

    to (mostly) set things back to how they were before.
\end{sphinxVerbatim}


\subsection{Update \sphinxstyleliteralintitle{\sphinxupquote{PATH}}}
\label{\detokenize{Appendix1:Update-PATH}}
Recall that \sphinxcode{\sphinxupquote{PATH}} is a list (separated by \sphinxcode{\sphinxupquote{:}}) fo directories to search for executables, e.g.:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}

Then, if we want to put a \sphinxcode{\sphinxupquote{librat}} directory at the front of this path (so we look there first), we follow the following example syntax:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[15]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} example initial setting of PATH}
\PYG{c+c1}{\PYGZsh{} NB Only an example, your shell will set something}
\PYG{c+c1}{\PYGZsh{} different!}
\PYG{n+nv}{PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1. PATH is }\PYG{n+nv}{\PYGZdl{}PATH}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nv}{HERE}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{p}{;}\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{p}{;}\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}HERE}

\PYG{n+nv}{bin}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/src

\PYG{c+c1}{\PYGZsh{} put \PYGZdl{}bin on the front of PATH}
\PYG{n+nb}{export} \PYG{n+nv}{PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}bin}\PYG{l+s+s2}{:}\PYG{n+nv}{\PYGZdl{}PATH}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2. PATH is }\PYG{n+nv}{\PYGZdl{}PATH}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. PATH is /usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
2. PATH is /Users/plewis/librat/src:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
\end{sphinxVerbatim}
}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
EXERCISE

    1. Edit your \PYGZti{}/.bash\PYGZus{}profile to update your PATH variable

    You should type the following lines into the end of \PYGZti{}/.bash\PYGZus{}profile:

    \PYGZsh{} replace this line below by BPMS= the location of your librat dist
    BPMS=/Users/plewis/librat
    bin=\PYGZdl{}BPMS/src
    export PATH=\PYGZdq{}\PYGZdl{}bin:\PYGZdl{}PATH\PYGZdq{}


    2. Save the file and quit the editor.

    3. Open a new shell. At the command prompt, type:

            source \PYGZti{}/.bash\PYGZus{}profile

    Then

            echo \PYGZdl{}PATH

    It should show the updated PATH variable.
\end{sphinxVerbatim}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{LD\_LIBRARY\_PATH}}, \sphinxstyleliteralintitle{\sphinxupquote{DYLD\_LIBRARY\_PATH}}}
\label{\detokenize{Appendix1:LD_LIBRARY_PATH,-DYLD_LIBRARY_PATH}}
On some systems, \sphinxcode{\sphinxupquote{LD\_LIBRARY\_PATH}} and/or \sphinxcode{\sphinxupquote{DYLD\_LIBRARY\_PATH}} may be set in your \sphinxcode{\sphinxupquote{bash}} shell. Just to make sure, we will set them in our examples.

These variables tell an executable where to look for shared object libraries (libraries of functions stored on the computer). Again, they are simply lists of locations (directories) in the computer file system that the shell will look. Elements of the list are separated by \sphinxcode{\sphinxupquote{:}}. so, if for example we have the \sphinxcode{\sphinxupquote{PATH}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/usr/local/lib:/usr/lib}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/usr/local/lib:/usr/lib}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}

then when an executable makes a call to a function in a shared object library, it will look first in \sphinxcode{\sphinxupquote{/usr/local/lib}}, and then in \sphinxcode{\sphinxupquote{/usr/lib}} for these libraries.


\subsection{Update \sphinxstyleliteralintitle{\sphinxupquote{LD\_LIBRARY\_PATH}}, \sphinxstyleliteralintitle{\sphinxupquote{DYLD\_LIBRARY\_PATH}}}
\label{\detokenize{Appendix1:Update-LD_LIBRARY_PATH,-DYLD_LIBRARY_PATH}}
We can again add search directories to the front of the library paths:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[16]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} example initial setting of LD\PYGZus{}LIBRARY\PYGZus{}PATH}
\PYG{c+c1}{\PYGZsh{} NB Only an example, your shell will set something}
\PYG{c+c1}{\PYGZsh{} different!}
\PYG{n+nv}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/usr/local/lib:/usr/lib\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1. LD\PYGZus{}LIBRARY\PYGZus{}PATH is }\PYG{n+nv}{\PYGZdl{}LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nv}{HERE}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{p}{;}\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{p}{;}\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}HERE}

\PYG{n+nv}{lib}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/src

\PYG{c+c1}{\PYGZsh{} put \PYGZdl{}bin on the front of PATH}
\PYG{n+nb}{export} \PYG{n+nv}{LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lib}\PYG{l+s+s2}{:}\PYG{n+nv}{\PYGZdl{}LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2. LD\PYGZus{}LIBRARY\PYGZus{}PATH is }\PYG{n+nv}{\PYGZdl{}LD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. LD\_LIBRARY\_PATH is /usr/local/lib:/usr/lib
2. LD\_LIBRARY\_PATH is /Users/plewis/librat/src:/usr/local/lib:/usr/lib
\end{sphinxVerbatim}
}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[17]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} example initial setting of DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}
\PYG{c+c1}{\PYGZsh{} NB Only an example, your shell will set something}
\PYG{c+c1}{\PYGZsh{} different!}
\PYG{n+nv}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}/usr/local/lib:/usr/lib\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1. DYLD\PYGZus{}LIBRARY\PYGZus{}PATH is }\PYG{n+nv}{\PYGZdl{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}


\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nv}{HERE}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{p}{;}\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{p}{;}\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}HERE}

\PYG{n+nv}{lib}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/src

\PYG{c+c1}{\PYGZsh{} put \PYGZdl{}bin on the front of PATH}
\PYG{n+nb}{export} \PYG{n+nv}{DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{n+nv}{\PYGZdl{}lib}\PYG{l+s+s2}{:}\PYG{n+nv}{\PYGZdl{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2. DYLD\PYGZus{}LIBRARY\PYGZus{}PATH is }\PYG{n+nv}{\PYGZdl{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
1. DYLD\_LIBRARY\_PATH is /usr/local/lib:/usr/lib
2. DYLD\_LIBRARY\_PATH is /Users/plewis/librat/src:/usr/local/lib:/usr/lib
\end{sphinxVerbatim}
}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
EXERCISE

    1. Similar to the previous exercise, edit your \PYGZti{}/.bash\PYGZus{}profile to now update your LD\PYGZus{}LIBRARY\PYGZus{}PATH and DYLD\PYGZus{}LIBRARY\PYGZus{}PATH variables

    You should type the following lines into the end of \PYGZti{}/.bash\PYGZus{}profile:

    \PYGZsh{} replace this line below by BPMS= the location of your librat dist
    BPMS=/Users/plewis/librat
    lib=\PYGZdl{}BPMS/src
    export LD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZdl{}lib:\PYGZdl{}LD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZdq{}
    export DYLD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZdl{}lib:\PYGZdl{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZdq{}


    2. Save the file and quit the editor.

    3. Open a new shell. At the command prompt, type:

            source \PYGZti{}/.bash\PYGZus{}profile

    Then

            echo \PYGZdl{}LD\PYGZus{}LIBRARY\PYGZus{}PATH \PYGZdl{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH

    It should show the updated variables.
\end{sphinxVerbatim}


\subsection{Which operating system? \sphinxstyleliteralintitle{\sphinxupquote{uname}}, \sphinxstyleliteralintitle{\sphinxupquote{if}}}
\label{\detokenize{Appendix1:Which-operating-system?-uname,-if}}
Before proceeding, it is useful to see how to determine which operatinbg system we are using, and how to perform conditional statements in \sphinxcode{\sphinxupquote{bash}}.

Mostly, you can get information on which operating system you are using by using either \sphinxcode{\sphinxupquote{uname \sphinxhyphen{}s}}. You may sometime have problems if you are using virtual machines of any sort, as the top level operating system may not be apparant.

In the example below, we use \sphinxcode{\sphinxupquote{uname \sphinxhyphen{}s}} to test for values of \sphinxcode{\sphinxupquote{MINGW64}} (a common windows environment with compilers and some other useful features), \sphinxcode{\sphinxupquote{Darwin}} (macOS of some sort), or other (assumed linux).

We set the variabler \sphinxcode{\sphinxupquote{OS}} to the result of running \sphinxcode{\sphinxupquote{uname \sphinxhyphen{}s}}, then use bash conditional statement syntax:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
if [ \PYGZdl{}VAR = value1 ]
then
  ... do something 1 ...
elif [ \PYGZdl{}VAR = value2 ]
then
  ... do something 2 ...
else
  ... do something else ...
fi
\end{sphinxVerbatim}

to test the options we consider. The syntax is a little fiddly.

Note that the spaces in \sphinxcode{\sphinxupquote{if {[} \$VAR = value1 {]}}} are critical. Note that the \sphinxcode{\sphinxupquote{then}} statements are also critical.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[18]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} these to see what sort of computer we are running on}
\PYG{n+nv}{OS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}uname \PYGZhy{}s\PYG{k}{)}

\PYG{c+c1}{\PYGZsh{} print the first 5 lines in the shared object}
\PYG{k}{if} \PYG{o}{[} \PYG{n+nv}{\PYGZdl{}OS} \PYG{o}{=} MINGW64 \PYG{o}{]}
\PYG{k}{then}
  \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{I am windows: }\PYG{n+nv}{\PYGZdl{}OS}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{elif} \PYG{o}{[} \PYG{n+nv}{\PYGZdl{}OS} \PYG{o}{=} Darwin \PYG{o}{]}
\PYG{k}{then}
  \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{I am macOS: }\PYG{n+nv}{\PYGZdl{}OS}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{else}
  \PYG{n+nb}{echo} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{I am neither macOS nor MINGW64: }\PYG{n+nv}{\PYGZdl{}OS}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{k}{fi}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
I am macOS: Darwin
\end{sphinxVerbatim}
}


\subsection{Contents of libraries: \sphinxstyleliteralintitle{\sphinxupquote{nm}} or \sphinxstyleliteralintitle{\sphinxupquote{ar}}}
\label{\detokenize{Appendix1:Contents-of-libraries:-nm-or-ar}}
The libraries will have the suffix \sphinxhref{https://en.wikipedia.org/wiki/Dynamic-link\_library}{dll} on windows systems. On various unix systems, they may be \sphinxhref{https://en.wikipedia.org/wiki/Library\_(computing)\#Shared\_libraries}{so} or for on \sphinxcode{\sphinxupquote{OS X}}, \sphinxhref{https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/000-Introduction/Introduction.html}{dylib}. Normally, you will only need \sphinxcode{\sphinxupquote{DYLD\_LIBRARY\_PATH}} on \sphinxcode{\sphinxupquote{OS X}}, but we might as well set it for all
cases. If you want to see which functions are contained in a particular library then:

On \sphinxcode{\sphinxupquote{OS X}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
nm \PYGZhy{}gU  src/libratlib.\PYGZdl{}\PYGZob{}ext\PYGZcb{}
\end{sphinxVerbatim}

Otherwise:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
ar tv src/libratlib.\PYGZdl{}\PYGZob{}ext\PYGZcb{}
\end{sphinxVerbatim}

where \sphinxcode{\sphinxupquote{\$\{ext\}}} is \sphinxcode{\sphinxupquote{so}} or \sphinxcode{\sphinxupquote{dll}} or \sphinxcode{\sphinxupquote{dylib}} as appropriate. We use the construct above for determining the operating system and for using \sphinxcode{\sphinxupquote{ar}} or \sphinxcode{\sphinxupquote{nm}} as appropriate.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[19]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} these to see what sort of computer we are running on}
\PYG{n+nv}{OS}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}uname \PYGZhy{}s\PYG{k}{)}
\PYG{n+nb}{echo} \PYG{n+nv}{\PYGZdl{}OS}

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nv}{HERE}\PYG{o}{=}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{p}{;}\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}\PYG{p}{;}\PYG{n+nb}{cd} \PYG{n+nv}{\PYGZdl{}HERE}

\PYG{n+nv}{lib}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/src


\PYG{c+c1}{\PYGZsh{} print the first 5 lines in the shared object}
\PYG{k}{if} \PYG{o}{[} \PYG{n+nv}{\PYGZdl{}OS} \PYG{o}{=} MINGW64 \PYG{o}{]}
\PYG{k}{then}
  \PYG{c+c1}{\PYGZsh{} windows}
  ar tv \PYG{n+nv}{\PYGZdl{}lib}/libratlib.dll \PYG{p}{|} head \PYGZhy{}5
\PYG{k}{elif} \PYG{o}{[} \PYG{n+nv}{\PYGZdl{}OS} \PYG{o}{=} Darwin \PYG{o}{]}
\PYG{k}{then}
  \PYG{c+c1}{\PYGZsh{} OS X}
  nm \PYGZhy{}gU \PYG{n+nv}{\PYGZdl{}lib}/libratlib.so \PYG{p}{|} head \PYGZhy{}5
\PYG{k}{else}
  \PYG{c+c1}{\PYGZsh{} linux}
  ar tv \PYG{n+nv}{\PYGZdl{}lib}/libratlib.dll \PYG{p}{|} head \PYGZhy{}5
\PYG{k}{fi}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Darwin
0000000000047500 T \_Add\_2D
00000000000477c0 T \_Affine\_transform
0000000000049090 T \_B\_allocate
00000000000477f0 T \_Backwards\_affine\_transform
00000000000470b0 T \_Bbox
\end{sphinxVerbatim}
}

where we see that the shared object library for \sphinxcode{\sphinxupquote{librat}} (in a file called \sphinxcode{\sphinxupquote{libratlib.\$\{ext\}}}) contains some functions \sphinxcode{\sphinxupquote{\_Add\_2D()}}, \sphinxcode{\sphinxupquote{\_Affine\_transform()}} etc. which are part of the library we use.

Notice that \sphinxcode{\sphinxupquote{lib.\$\{ext\}}} is added on the end of a library name to give its filename.


\section{Important environment variables for \sphinxstyleliteralintitle{\sphinxupquote{librat}}}
\label{\detokenize{Appendix1:Important-environment-variables-for-librat}}

\subsection{\sphinxstyleliteralintitle{\sphinxupquote{cat \textless{}\textless{}EOF \textgreater{} output ... EOF}}}
\label{\detokenize{Appendix1:cat-<<EOF->-output-...-EOF}}
We can conveniently create files in \sphinxcode{\sphinxupquote{bash}} from text in the bash shell. This is done using \sphinxcode{\sphinxupquote{cat}} and defining a marker (often \sphinxcode{\sphinxupquote{EOF}}, meaning End Of File), such as:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[20]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}BPMS/test/test\PYGZus{}examples/first.obj}
\PYG{l+s}{\PYGZsh{} My first object file}
\PYG{l+s}{mtllib plants.matlib}
\PYG{l+s}{usemtl white}
\PYG{l+s}{v 0 0 0}
\PYG{l+s}{v 0 0 1}
\PYG{l+s}{plane \PYGZhy{}1 \PYGZhy{}2}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{usemtl white}
\PYG{l+s}{!\PYGZob{}}
\PYG{l+s}{v 0 0 1000}
\PYG{l+s}{ell \PYGZhy{}1 30000 30000 1000}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{!\PYGZcb{}}
\PYG{l+s}{EOF}
\end{sphinxVerbatim}
}

Letâ€™s look at the file we have just created:

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[21]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}

cat \PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/first.obj
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\# My first object file
mtllib plants.matlib
usemtl white
v 0 0 0
v 0 0 1
plane -1 -2
!\{
usemtl white
!\{
v 0 0 1000
ell -1 30000 30000 1000
!\}
!\}
\end{sphinxVerbatim}
}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
EXERCISE

Use the approach above (`cat \PYGZlt{}\PYGZlt{}EOF \PYGZgt{} output ... EOF`) to create your own text file, then check the contents are as you expected.
\end{sphinxVerbatim}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{MATLIB}}, \sphinxstyleliteralintitle{\sphinxupquote{RSRLIB}} etc.}
\label{\detokenize{Appendix1:MATLIB,-RSRLIB-etc.}}
In \sphinxcode{\sphinxupquote{librat}}, there is a considerable set of data that we need to describe world data for any particular simulation. For example, we need to have one or more object files giving the geometry, material files describing the spectral scattering properties of materials, sensor spectral response functions etc.

To try to make models and simulation scenarios portable, we want to avoid â€˜hardwiringâ€™ these file locations. One way to do that is to simply use relative file names throughout the description, so that we can then determine the full filenames from some core base directory.

If we happen to run the simulation \sphinxstyleemphasis{from} this directory, then clearly the relative filenames we use would directly describe all file locations.

However, if we run the simulation from elsewhere on the system, we need a mechanism to describe the \sphinxstyleemphasis{base} of the scene description files. More generally, we might want to store spectral response files in one part of the file system, and spectral scattering properties elsewhere. In that case, we need a set of \sphinxstyleemphasis{base} descriptors for these different types of file.

That is the file system philosophy used in \sphinxcode{\sphinxupquote{librat}}. These \sphinxstyleemphasis{base} locations are defined by environment variables which we will describe below. Whilst you do not \sphinxstyleemphasis{have} to use these, it makes sense to set them up, even if they are all set to the same value (i.e.Â the \sphinxstyleemphasis{base} of the model files is the same for all file types).

The following environmental variables can be used:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
File types
\\
\hline
\sphinxcode{\sphinxupquote{MATLIB}}
&
material library e.g. \sphinxhref{test/test\_examples/plants.matlib}{plants.matlib}, all materials defined in a material library e.g. \sphinxhref{test/test\_examples/refl/white.dat}{refl/white.dat}
\\
\hline
\sphinxcode{\sphinxupquote{ARARAT\_OBJECT}}
&
(extended) wavefront object files e.g. \sphinxhref{test/test\_examples/first.obj}{first.obj}
\\
\hline
\sphinxcode{\sphinxupquote{DIRECT\_ILLUMINATION}}
&
spectral files for direct illumination: those defined in \sphinxhyphen{}RATdirect command line option
\\
\hline
\sphinxcode{\sphinxupquote{RSRLIB}}
&
sensor waveband files: those defined in \sphinxhyphen{}RATsensor\_wavebands command line option
\\
\hline
\sphinxcode{\sphinxupquote{BPMS\_FILES}}
&
Not used
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

As noted, you can set all of these to the same value, in which case the database of files is all defined relative to that point. This is the most typical use of \sphinxcode{\sphinxupquote{librat}}. We illustrate this setup below for the \sphinxcode{\sphinxupquote{librat}} distribution, where a set of examples use files from the directory \sphinxcode{\sphinxupquote{test/test\_examples}}.

Additionally, the following environment variables can be set to extend the size of some aspects of the model. You would only need to use these in some extreme case.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
Name
&\sphinxstyletheadfamily 
Purpose
\\
\hline
\sphinxcode{\sphinxupquote{MAX\_GROUPS}}
&
Maximum number of groups allowed (100000)
\\
\hline
\sphinxcode{\sphinxupquote{PRAT\_MAX\_MATERIALS}}
&
Maximum number of materials allowed (DEFAULT\_PRAT\_MAX\_MATERIALS=1024 in \sphinxcode{\sphinxupquote{mtllib.h}})
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[22]:\,\hspace{\fboxrule}\hspace{\fboxsep}}\PYGZpc{}\PYGZpc{}bash

\PYG{c+c1}{\PYGZsh{} change directory from docs/source up to root}
\PYG{n+nb}{cd} ../..
\PYG{n+nv}{BPMS}\PYG{o}{=}\PYG{l+s+si}{\PYGZdl{}\PYGZob{}}\PYG{n+nv}{BPMS}\PYG{p}{\PYGZhy{}}\PYG{k}{\PYGZdl{}(}\PYG{n+nb}{pwd}\PYG{k}{)}\PYG{l+s+si}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{} create the init.sh file we want}
\PYG{n+nv}{INIT}\PYG{o}{=}\PYG{n+nv}{\PYGZdl{}BPMS}/test/test\PYGZus{}examples/init.sh

cat \PYG{l+s}{\PYGZlt{}\PYGZlt{}EOF \PYGZgt{} \PYGZdl{}INIT}
\PYG{l+s}{\PYGZsh{}!/bin/bash}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{\PYGZsh{} preamble}
\PYG{l+s}{\PYGZsh{}}
\PYG{l+s}{export BPMS=\PYGZdl{}BPMS}

\PYG{l+s}{\PYGZsh{} set shell variables lib, bin, verbose}
\PYG{l+s}{\PYGZsh{} with defaults in case not set}
\PYG{l+s}{lib=\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{bin=\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/src\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{VERBOSE=\PYGZbs{}\PYGZdl{}\PYGZob{}VERBOSE\PYGZhy{}1\PYGZcb{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for bash}
\PYG{l+s}{export LD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}LD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export DYLD\PYGZus{}LIBRARY\PYGZus{}PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}lib\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}DYLD\PYGZus{}LIBRARY\PYGZus{}PATH\PYGZcb{}\PYGZdq{}}
\PYG{l+s}{export PATH=\PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}:\PYGZbs{}\PYGZdl{}\PYGZob{}PATH\PYGZcb{}\PYGZdq{}}

\PYG{l+s}{\PYGZsh{} set up required environment variables for librat}
\PYG{l+s}{export BPMSROOT=\PYGZbs{}\PYGZdl{}\PYGZob{}BPMSROOT\PYGZhy{}\PYGZdq{}\PYGZbs{}\PYGZdl{}BPMS/test/test\PYGZus{}examples\PYGZdq{}\PYGZcb{}}
\PYG{l+s}{export MATLIB=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export RSRLIB=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export ARARAT\PYGZus{}OBJECT=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export DIRECT\PYGZus{}ILLUMINATION=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{export BPMS\PYGZus{}FILES=\PYGZbs{}\PYGZdl{}BPMSROOT}
\PYG{l+s}{echo \PYGZdl{}BPMS}
\PYG{l+s}{if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}(which start)\PYGZdq{} == \PYGZdq{}\PYGZbs{}\PYGZdl{}\PYGZob{}bin\PYGZcb{}/start\PYGZdq{} ]}
\PYG{l+s}{then}
\PYG{l+s}{  if [ \PYGZdq{}\PYGZbs{}\PYGZdl{}VERBOSE\PYGZdq{} == 1 ]; then}
\PYG{l+s}{      echo \PYGZdq{}start found ok\PYGZdq{}}
\PYG{l+s}{  fi}
\PYG{l+s}{else}
\PYG{l+s}{  \PYGZsh{} we should create them}
\PYG{l+s}{  make clean all}
\PYG{l+s}{fi}
\PYG{l+s}{EOF}
\PYG{c+c1}{\PYGZsh{} set executable mode}
chmod +x \PYG{n+nv}{\PYGZdl{}INIT}
\PYG{c+c1}{\PYGZsh{} test run}
\PYG{n+nb}{export} \PYG{n+nv}{VERBOSE}\PYG{o}{=}\PYG{l+m}{1}
\PYG{n+nv}{\PYGZdl{}INIT}
\end{sphinxVerbatim}
}

{

\kern-\sphinxverbatimsmallskipamount\kern-\baselineskip
\kern+\FrameHeightAdjust\kern-\fboxrule
\vspace{\nbsphinxcodecellspacing}

\sphinxsetup{VerbatimColor={named}{white}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
/Users/plewis/librat
start found ok
\end{sphinxVerbatim}
}


\section{Summary}
\label{\detokenize{Appendix1:Summary}}
In this chapter, we have covered a range of basic unix/linux and \sphinxcode{\sphinxupquote{bash}} commands, so you should be able to navigate you way around a unix file system, and find your way back safely. Being familiar with these tools takes somne time of course, so you might now want to go on and take \sphinxhref{https://www.unixtutorial.org/basic-unix-commands}{some other unix/linux course} to see if you can deepen your understanding in that way. Alternatively, just spend some time exploring your system, looking to see
what files are where, reading on the internet or help pages what they do, and so on.

Maybe thats wishful thinking on my part though. You may not feel you have time for basic unix at the moment â€¦ and we did say at the top of this chapter that it was not compulsory â€¦ Iâ€™d reccomend you \sphinxstyleemphasis{do} spend some time on \sphinxstyleemphasis{unix} â€¦ youâ€™ll develop skills that willlast you a lifetime! ;\sphinxhyphen{})

In practical terms, as we have said, the important thing here is that you can generate the file \sphinxcode{\sphinxupquote{test/test\_examples/init.sh}} and modify it to your needs.

{
\sphinxsetup{VerbatimColor={named}{nbsphinx-code-bg}}
\sphinxsetup{VerbatimBorderColor={named}{nbsphinx-code-border}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\llap{\color{nbsphinxin}[ ]:\,\hspace{\fboxrule}\hspace{\fboxsep}}
\end{sphinxVerbatim}
}


\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}



\renewcommand{\indexname}{Index}
\printindex
\end{document}